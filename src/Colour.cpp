/*
 *  Colour.cpp
 *  GaitSym2019
 *
 *  Created by Bill Sellers on 29/3/2019.
 *  Copyright 2019 Bill Sellers. All rights reserved.
 *
 */

#include "Colour.h"

#include "pystring.h"

#include <unordered_map>
#include <cctype>
#include <regex>
#include <cstdint>

using namespace  std::string_literals;

Colour::Colour()
{
}

Colour::Colour(float index, ColourMap m, bool invert)
{
    SetColourFromMap(index, m, this, invert);
}

Colour::Colour(const std::string &str)
{
    if (!SetColourFromString(str, this)) this->SetColour(0.f, 0.f, 0.f, 1.f);
}

void Colour::SetColour(float index, ColourMap m, bool invert)
{
    SetColourFromMap(index, m, this, invert);
}

bool Colour::SetColour(const std::string &name)
{
    return SetColourFromString(name, this);
}

bool Colour::SetColourFromString(const std::string &str, Colour *stringColour)
{
    // is name a set of 3 or 4 numbers?
    std::vector< std::string > result;
    pystring::split(str, result);
    if (result.size() == 3)
    {
        if (IsInt(result[0]) && IsInt(result[1]) && IsInt(result[2]))
        {
            stringColour->SetColour(std::strtol(result[0].c_str(), nullptr, 0), std::strtol(result[1].c_str(), nullptr, 0), std::strtol(result[2].c_str(), nullptr, 0), 255);
            return true;
        }
        if (IsNumber(result[0]) && IsNumber(result[1]) && IsNumber(result[2]))
        {
            stringColour->SetColour(std::stof(result[0]), std::stof(result[1]), std::stof(result[2]), 1.0f);
            return true;
        }
        return SetColourFromName(str, stringColour);
    }
    if (result.size() == 4)
    {
        if (IsInt(result[0]) && IsInt(result[1]) && IsInt(result[2]) && IsInt(result[3]))
        {
            stringColour->SetColour(int(std::strtol(result[0].c_str(), nullptr, 0)), int(std::strtol(result[1].c_str(), nullptr, 0)), int(std::strtol(result[2].c_str(), nullptr, 0)), int(std::strtol(result[3].c_str(), nullptr, 0)));
            return true;
        }
        if (IsNumber(result[0]) && IsNumber(result[1]) && IsNumber(result[2]) && IsNumber(result[3]))
        {
            stringColour->SetColour(std::stof(result[0]), std::stof(result[1]), std::stof(result[2]), std::stof(result[3]));
            return true;
        }
        return SetColourFromName(str, stringColour);
    }
    return SetColourFromName(str, stringColour);
}


bool Colour::IsNumber(const std::string &s)
{
    std::regex e("^([+-]?)(?=[0-9]|\\.[0-9])[0-9]*(\\.[0-9]*)?([Ee]([+-]?[0-9]+))?$");
    return std::regex_match (s, e);
}

float Colour::r() const
{
    return m_r;
}

void Colour::setR(float r)
{
    m_r = r;
}

float Colour::g() const
{
    return m_g;
}

void Colour::setG(float g)
{
    m_g = g;
}

float Colour::b() const
{
    return m_b;
}

void Colour::setB(float b)
{
    m_b = b;
}

float Colour::alpha() const
{
    return m_alpha;
}

void Colour::setAlpha(float alpha)
{
    m_alpha = alpha;
}

bool Colour::IsInt(const std::string &s)
{
    std::regex e("^(?:(0[xX][a-fA-F0-9]+(?:[uU](?:ll|LL|[lL])?|(?:ll|LL|[lL])[uU]?)?)"           // Hexadecimal
                 "|([1-9][0-9]*(?:[uU](?:ll|LL|[lL])?|(?:ll|LL|[lL])[uU]?)?)"                    // Decimal
                 "|(0[0-7]*(?:[uU](?:ll|LL|[lL])?|(?:ll|LL|[lL])[uU]?)?))$"s);                   // Octal
    return std::regex_match (s, e);
}

std::string Colour::GetFloatColourRGBA()
{
    std::string output;
    char buf[32 * 4];
    int l = snprintf(buf, sizeof(buf), "%.7f %.7f %.7f %.7f", double(m_r), double(m_g), double(m_b), double(m_alpha));
    output.assign(buf, size_t(l));
    return output;
}

std::string Colour::GetIntColourRGBA()
{
    std::string output;
    char buf[32 * 4];
    int l = snprintf(buf, sizeof(buf), "%d %d %d %d", int(0.5f+m_r*255.0f), int(0.5f+m_g*255.0f), int(0.5f+m_b*255.0f), int(0.5f+m_alpha*255.0f));
    output.assign(buf, size_t(l));
    return output;
}

std::string Colour::GetHexArgb()
{
    // name is #AARRGGBB
    std::string output;
    char buf[16];
    int l = snprintf(buf, sizeof(buf), "#%02x%02x%02x%02x", int(0.5f+m_alpha*255.0f), int(0.5f+m_r*255.0f), int(0.5f+m_g*255.0f), int(0.5f+m_b*255.0f));
    output.assign(buf, size_t(l));
    return output;
}

bool Colour::SetColourFromName(const std::string &name, Colour *namedColour)
{
    const std::unordered_map<std::string, uint64_t> colourNameMap(
    {
        {"snow",0xfffafa},
        {"ghost white",0xf8f8ff},
        {"ghostwhite",0xf8f8ff},
        {"white smoke",0xf5f5f5},
        {"whitesmoke",0xf5f5f5},
        {"gainsboro",0xdcdcdc},
        {"floral white",0xfffaf0},
        {"floralwhite",0xfffaf0},
        {"old lace",0xfdf5e6},
        {"oldlace",0xfdf5e6},
        {"linen",0xfaf0e6},
        {"antique white",0xfaebd7},
        {"antiquewhite",0xfaebd7},
        {"papaya whip",0xffefd5},
        {"papayawhip",0xffefd5},
        {"blanched almond",0xffebcd},
        {"blanchedalmond",0xffebcd},
        {"bisque",0xffe4c4},
        {"peach puff",0xffdab9},
        {"peachpuff",0xffdab9},
        {"navajo white",0xffdead},
        {"navajowhite",0xffdead},
        {"moccasin",0xffe4b5},
        {"cornsilk",0xfff8dc},
        {"ivory",0xfffff0},
        {"lemon chiffon",0xfffacd},
        {"lemonchiffon",0xfffacd},
        {"seashell",0xfff5ee},
        {"honeydew",0xf0fff0},
        {"mint cream",0xf5fffa},
        {"mintcream",0xf5fffa},
        {"azure",0xf0ffff},
        {"alice blue",0xf0f8ff},
        {"aliceblue",0xf0f8ff},
        {"lavender",0xe6e6fa},
        {"lavender blush",0xfff0f5},
        {"lavenderblush",0xfff0f5},
        {"misty rose",0xffe4e1},
        {"mistyrose",0xffe4e1},
        {"white",0xffffff},
        {"black",0x000000},
        {"dark slate gray",0x2f4f4f},
        {"darkslategray",0x2f4f4f},
        {"dark slate grey",0x2f4f4f},
        {"darkslategrey",0x2f4f4f},
        {"dim gray",0x696969},
        {"dimgray",0x696969},
        {"dim grey",0x696969},
        {"dimgrey",0x696969},
        {"slate gray",0x708090},
        {"slategray",0x708090},
        {"slate grey",0x708090},
        {"slategrey",0x708090},
        {"light slate gray",0x778899},
        {"lightslategray",0x778899},
        {"light slate grey",0x778899},
        {"lightslategrey",0x778899},
        {"gray",0xbebebe},
        {"grey",0xbebebe},
        {"light grey",0xd3d3d3},
        {"lightgrey",0xd3d3d3},
        {"light gray",0xd3d3d3},
        {"lightgray",0xd3d3d3},
        {"midnight blue",0x191970},
        {"midnightblue",0x191970},
        {"navy",0x000080},
        {"navy blue",0x000080},
        {"navyblue",0x000080},
        {"cornflower blue",0x6495ed},
        {"cornflowerblue",0x6495ed},
        {"dark slate blue",0x483d8b},
        {"darkslateblue",0x483d8b},
        {"slate blue",0x6a5acd},
        {"slateblue",0x6a5acd},
        {"medium slate blue",0x7b68ee},
        {"mediumslateblue",0x7b68ee},
        {"light slate blue",0x8470ff},
        {"lightslateblue",0x8470ff},
        {"medium blue",0x0000cd},
        {"mediumblue",0x0000cd},
        {"royal blue",0x4169e1},
        {"royalblue",0x4169e1},
        {"blue",0x0000ff},
        {"dodger blue",0x1e90ff},
        {"dodgerblue",0x1e90ff},
        {"deep sky blue",0x00bfff},
        {"deepskyblue",0x00bfff},
        {"sky blue",0x87ceeb},
        {"skyblue",0x87ceeb},
        {"light sky blue",0x87cefa},
        {"lightskyblue",0x87cefa},
        {"steel blue",0x4682b4},
        {"steelblue",0x4682b4},
        {"light steel blue",0xb0c4de},
        {"lightsteelblue",0xb0c4de},
        {"light blue",0xadd8e6},
        {"lightblue",0xadd8e6},
        {"powder blue",0xb0e0e6},
        {"powderblue",0xb0e0e6},
        {"pale turquoise",0xafeeee},
        {"paleturquoise",0xafeeee},
        {"dark turquoise",0x00ced1},
        {"darkturquoise",0x00ced1},
        {"medium turquoise",0x48d1cc},
        {"mediumturquoise",0x48d1cc},
        {"turquoise",0x40e0d0},
        {"cyan",0x00ffff},
        {"light cyan",0xe0ffff},
        {"lightcyan",0xe0ffff},
        {"cadet blue",0x5f9ea0},
        {"cadetblue",0x5f9ea0},
        {"medium aquamarine",0x66cdaa},
        {"mediumaquamarine",0x66cdaa},
        {"aquamarine",0x7fffd4},
        {"dark green",0x006400},
        {"darkgreen",0x006400},
        {"dark olive green",0x556b2f},
        {"darkolivegreen",0x556b2f},
        {"dark sea green",0x8fbc8f},
        {"darkseagreen",0x8fbc8f},
        {"sea green",0x2e8b57},
        {"seagreen",0x2e8b57},
        {"medium sea green",0x3cb371},
        {"mediumseagreen",0x3cb371},
        {"light sea green",0x20b2aa},
        {"lightseagreen",0x20b2aa},
        {"pale green",0x98fb98},
        {"palegreen",0x98fb98},
        {"spring green",0x00ff7f},
        {"springgreen",0x00ff7f},
        {"lawn green",0x7cfc00},
        {"lawngreen",0x7cfc00},
        {"green",0x00ff00},
        {"chartreuse",0x7fff00},
        {"medium spring green",0x00fa9a},
        {"mediumspringgreen",0x00fa9a},
        {"green yellow",0xadff2f},
        {"greenyellow",0xadff2f},
        {"lime green",0x32cd32},
        {"limegreen",0x32cd32},
        {"yellow green",0x9acd32},
        {"yellowgreen",0x9acd32},
        {"forest green",0x228b22},
        {"forestgreen",0x228b22},
        {"olive drab",0x6b8e23},
        {"olivedrab",0x6b8e23},
        {"dark khaki",0xbdb76b},
        {"darkkhaki",0xbdb76b},
        {"khaki",0xf0e68c},
        {"pale goldenrod",0xeee8aa},
        {"palegoldenrod",0xeee8aa},
        {"light goldenrod yellow",0xfafad2},
        {"lightgoldenrodyellow",0xfafad2},
        {"light yellow",0xffffe0},
        {"lightyellow",0xffffe0},
        {"yellow",0xffff00},
        {"gold",0xffd700},
        {"light goldenrod",0xeedd82},
        {"lightgoldenrod",0xeedd82},
        {"goldenrod",0xdaa520},
        {"dark goldenrod",0xb8860b},
        {"darkgoldenrod",0xb8860b},
        {"rosy brown",0xbc8f8f},
        {"rosybrown",0xbc8f8f},
        {"indian red",0xcd5c5c},
        {"indianred",0xcd5c5c},
        {"saddle brown",0x8b4513},
        {"saddlebrown",0x8b4513},
        {"sienna",0xa0522d},
        {"peru",0xcd853f},
        {"burlywood",0xdeb887},
        {"beige",0xf5f5dc},
        {"wheat",0xf5deb3},
        {"sandy brown",0xf4a460},
        {"sandybrown",0xf4a460},
        {"tan",0xd2b48c},
        {"chocolate",0xd2691e},
        {"firebrick",0xb22222},
        {"brown",0xa52a2a},
        {"dark salmon",0xe9967a},
        {"darksalmon",0xe9967a},
        {"salmon",0xfa8072},
        {"light salmon",0xffa07a},
        {"lightsalmon",0xffa07a},
        {"orange",0xffa500},
        {"dark orange",0xff8c00},
        {"darkorange",0xff8c00},
        {"coral",0xff7f50},
        {"light coral",0xf08080},
        {"lightcoral",0xf08080},
        {"tomato",0xff6347},
        {"orange red",0xff4500},
        {"orangered",0xff4500},
        {"red",0xff0000},
        {"hot pink",0xff69b4},
        {"hotpink",0xff69b4},
        {"deep pink",0xff1493},
        {"deeppink",0xff1493},
        {"pink",0xffc0cb},
        {"light pink",0xffb6c1},
        {"lightpink",0xffb6c1},
        {"pale violet red",0xdb7093},
        {"palevioletred",0xdb7093},
        {"maroon",0xb03060},
        {"medium violet red",0xc71585},
        {"mediumvioletred",0xc71585},
        {"violet red",0xd02090},
        {"violetred",0xd02090},
        {"magenta",0xff00ff},
        {"violet",0xee82ee},
        {"plum",0xdda0dd},
        {"orchid",0xda70d6},
        {"medium orchid",0xba55d3},
        {"mediumorchid",0xba55d3},
        {"dark orchid",0x9932cc},
        {"darkorchid",0x9932cc},
        {"dark violet",0x9400d3},
        {"darkviolet",0x9400d3},
        {"blue violet",0x8a2be2},
        {"blueviolet",0x8a2be2},
        {"purple",0xa020f0},
        {"medium purple",0x9370db},
        {"mediumpurple",0x9370db},
        {"thistle",0xd8bfd8},
        {"snow1",0xfffafa},
        {"snow2",0xeee9e9},
        {"snow3",0xcdc9c9},
        {"snow4",0x8b8989},
        {"seashell1",0xfff5ee},
        {"seashell2",0xeee5de},
        {"seashell3",0xcdc5bf},
        {"seashell4",0x8b8682},
        {"antiquewhite1",0xffefdb},
        {"antiquewhite2",0xeedfcc},
        {"antiquewhite3",0xcdc0b0},
        {"antiquewhite4",0x8b8378},
        {"bisque1",0xffe4c4},
        {"bisque2",0xeed5b7},
        {"bisque3",0xcdb79e},
        {"bisque4",0x8b7d6b},
        {"peachpuff1",0xffdab9},
        {"peachpuff2",0xeecbad},
        {"peachpuff3",0xcdaf95},
        {"peachpuff4",0x8b7765},
        {"navajowhite1",0xffdead},
        {"navajowhite2",0xeecfa1},
        {"navajowhite3",0xcdb38b},
        {"navajowhite4",0x8b795e},
        {"lemonchiffon1",0xfffacd},
        {"lemonchiffon2",0xeee9bf},
        {"lemonchiffon3",0xcdc9a5},
        {"lemonchiffon4",0x8b8970},
        {"cornsilk1",0xfff8dc},
        {"cornsilk2",0xeee8cd},
        {"cornsilk3",0xcdc8b1},
        {"cornsilk4",0x8b8878},
        {"ivory1",0xfffff0},
        {"ivory2",0xeeeee0},
        {"ivory3",0xcdcdc1},
        {"ivory4",0x8b8b83},
        {"honeydew1",0xf0fff0},
        {"honeydew2",0xe0eee0},
        {"honeydew3",0xc1cdc1},
        {"honeydew4",0x838b83},
        {"lavenderblush1",0xfff0f5},
        {"lavenderblush2",0xeee0e5},
        {"lavenderblush3",0xcdc1c5},
        {"lavenderblush4",0x8b8386},
        {"mistyrose1",0xffe4e1},
        {"mistyrose2",0xeed5d2},
        {"mistyrose3",0xcdb7b5},
        {"mistyrose4",0x8b7d7b},
        {"azure1",0xf0ffff},
        {"azure2",0xe0eeee},
        {"azure3",0xc1cdcd},
        {"azure4",0x838b8b},
        {"slateblue1",0x836fff},
        {"slateblue2",0x7a67ee},
        {"slateblue3",0x6959cd},
        {"slateblue4",0x473c8b},
        {"royalblue1",0x4876ff},
        {"royalblue2",0x436eee},
        {"royalblue3",0x3a5fcd},
        {"royalblue4",0x27408b},
        {"blue1",0x0000ff},
        {"blue2",0x0000ee},
        {"blue3",0x0000cd},
        {"blue4",0x00008b},
        {"dodgerblue1",0x1e90ff},
        {"dodgerblue2",0x1c86ee},
        {"dodgerblue3",0x1874cd},
        {"dodgerblue4",0x104e8b},
        {"steelblue1",0x63b8ff},
        {"steelblue2",0x5cacee},
        {"steelblue3",0x4f94cd},
        {"steelblue4",0x36648b},
        {"deepskyblue1",0x00bfff},
        {"deepskyblue2",0x00b2ee},
        {"deepskyblue3",0x009acd},
        {"deepskyblue4",0x00688b},
        {"skyblue1",0x87ceff},
        {"skyblue2",0x7ec0ee},
        {"skyblue3",0x6ca6cd},
        {"skyblue4",0x4a708b},
        {"lightskyblue1",0xb0e2ff},
        {"lightskyblue2",0xa4d3ee},
        {"lightskyblue3",0x8db6cd},
        {"lightskyblue4",0x607b8b},
        {"slategray1",0xc6e2ff},
        {"slategray2",0xb9d3ee},
        {"slategray3",0x9fb6cd},
        {"slategray4",0x6c7b8b},
        {"lightsteelblue1",0xcae1ff},
        {"lightsteelblue2",0xbcd2ee},
        {"lightsteelblue3",0xa2b5cd},
        {"lightsteelblue4",0x6e7b8b},
        {"lightblue1",0xbfefff},
        {"lightblue2",0xb2dfee},
        {"lightblue3",0x9ac0cd},
        {"lightblue4",0x68838b},
        {"lightcyan1",0xe0ffff},
        {"lightcyan2",0xd1eeee},
        {"lightcyan3",0xb4cdcd},
        {"lightcyan4",0x7a8b8b},
        {"paleturquoise1",0xbbffff},
        {"paleturquoise2",0xaeeeee},
        {"paleturquoise3",0x96cdcd},
        {"paleturquoise4",0x668b8b},
        {"cadetblue1",0x98f5ff},
        {"cadetblue2",0x8ee5ee},
        {"cadetblue3",0x7ac5cd},
        {"cadetblue4",0x53868b},
        {"turquoise1",0x00f5ff},
        {"turquoise2",0x00e5ee},
        {"turquoise3",0x00c5cd},
        {"turquoise4",0x00868b},
        {"cyan1",0x00ffff},
        {"cyan2",0x00eeee},
        {"cyan3",0x00cdcd},
        {"cyan4",0x008b8b},
        {"darkslategray1",0x97ffff},
        {"darkslategray2",0x8deeee},
        {"darkslategray3",0x79cdcd},
        {"darkslategray4",0x528b8b},
        {"aquamarine1",0x7fffd4},
        {"aquamarine2",0x76eec6},
        {"aquamarine3",0x66cdaa},
        {"aquamarine4",0x458b74},
        {"darkseagreen1",0xc1ffc1},
        {"darkseagreen2",0xb4eeb4},
        {"darkseagreen3",0x9bcd9b},
        {"darkseagreen4",0x698b69},
        {"seagreen1",0x54ff9f},
        {"seagreen2",0x4eee94},
        {"seagreen3",0x43cd80},
        {"seagreen4",0x2e8b57},
        {"palegreen1",0x9aff9a},
        {"palegreen2",0x90ee90},
        {"palegreen3",0x7ccd7c},
        {"palegreen4",0x548b54},
        {"springgreen1",0x00ff7f},
        {"springgreen2",0x00ee76},
        {"springgreen3",0x00cd66},
        {"springgreen4",0x008b45},
        {"green1",0x00ff00},
        {"green2",0x00ee00},
        {"green3",0x00cd00},
        {"green4",0x008b00},
        {"chartreuse1",0x7fff00},
        {"chartreuse2",0x76ee00},
        {"chartreuse3",0x66cd00},
        {"chartreuse4",0x458b00},
        {"olivedrab1",0xc0ff3e},
        {"olivedrab2",0xb3ee3a},
        {"olivedrab3",0x9acd32},
        {"olivedrab4",0x698b22},
        {"darkolivegreen1",0xcaff70},
        {"darkolivegreen2",0xbcee68},
        {"darkolivegreen3",0xa2cd5a},
        {"darkolivegreen4",0x6e8b3d},
        {"khaki1",0xfff68f},
        {"khaki2",0xeee685},
        {"khaki3",0xcdc673},
        {"khaki4",0x8b864e},
        {"lightgoldenrod1",0xffec8b},
        {"lightgoldenrod2",0xeedc82},
        {"lightgoldenrod3",0xcdbe70},
        {"lightgoldenrod4",0x8b814c},
        {"lightyellow1",0xffffe0},
        {"lightyellow2",0xeeeed1},
        {"lightyellow3",0xcdcdb4},
        {"lightyellow4",0x8b8b7a},
        {"yellow1",0xffff00},
        {"yellow2",0xeeee00},
        {"yellow3",0xcdcd00},
        {"yellow4",0x8b8b00},
        {"gold1",0xffd700},
        {"gold2",0xeec900},
        {"gold3",0xcdad00},
        {"gold4",0x8b7500},
        {"goldenrod1",0xffc125},
        {"goldenrod2",0xeeb422},
        {"goldenrod3",0xcd9b1d},
        {"goldenrod4",0x8b6914},
        {"darkgoldenrod1",0xffb90f},
        {"darkgoldenrod2",0xeead0e},
        {"darkgoldenrod3",0xcd950c},
        {"darkgoldenrod4",0x8b6508},
        {"rosybrown1",0xffc1c1},
        {"rosybrown2",0xeeb4b4},
        {"rosybrown3",0xcd9b9b},
        {"rosybrown4",0x8b6969},
        {"indianred1",0xff6a6a},
        {"indianred2",0xee6363},
        {"indianred3",0xcd5555},
        {"indianred4",0x8b3a3a},
        {"sienna1",0xff8247},
        {"sienna2",0xee7942},
        {"sienna3",0xcd6839},
        {"sienna4",0x8b4726},
        {"burlywood1",0xffd39b},
        {"burlywood2",0xeec591},
        {"burlywood3",0xcdaa7d},
        {"burlywood4",0x8b7355},
        {"wheat1",0xffe7ba},
        {"wheat2",0xeed8ae},
        {"wheat3",0xcdba96},
        {"wheat4",0x8b7e66},
        {"tan1",0xffa54f},
        {"tan2",0xee9a49},
        {"tan3",0xcd853f},
        {"tan4",0x8b5a2b},
        {"chocolate1",0xff7f24},
        {"chocolate2",0xee7621},
        {"chocolate3",0xcd661d},
        {"chocolate4",0x8b4513},
        {"firebrick1",0xff3030},
        {"firebrick2",0xee2c2c},
        {"firebrick3",0xcd2626},
        {"firebrick4",0x8b1a1a},
        {"brown1",0xff4040},
        {"brown2",0xee3b3b},
        {"brown3",0xcd3333},
        {"brown4",0x8b2323},
        {"salmon1",0xff8c69},
        {"salmon2",0xee8262},
        {"salmon3",0xcd7054},
        {"salmon4",0x8b4c39},
        {"lightsalmon1",0xffa07a},
        {"lightsalmon2",0xee9572},
        {"lightsalmon3",0xcd8162},
        {"lightsalmon4",0x8b5742},
        {"orange1",0xffa500},
        {"orange2",0xee9a00},
        {"orange3",0xcd8500},
        {"orange4",0x8b5a00},
        {"darkorange1",0xff7f00},
        {"darkorange2",0xee7600},
        {"darkorange3",0xcd6600},
        {"darkorange4",0x8b4500},
        {"coral1",0xff7256},
        {"coral2",0xee6a50},
        {"coral3",0xcd5b45},
        {"coral4",0x8b3e2f},
        {"tomato1",0xff6347},
        {"tomato2",0xee5c42},
        {"tomato3",0xcd4f39},
        {"tomato4",0x8b3626},
        {"orangered1",0xff4500},
        {"orangered2",0xee4000},
        {"orangered3",0xcd3700},
        {"orangered4",0x8b2500},
        {"red1",0xff0000},
        {"red2",0xee0000},
        {"red3",0xcd0000},
        {"red4",0x8b0000},
        {"deeppink1",0xff1493},
        {"deeppink2",0xee1289},
        {"deeppink3",0xcd1076},
        {"deeppink4",0x8b0a50},
        {"hotpink1",0xff6eb4},
        {"hotpink2",0xee6aa7},
        {"hotpink3",0xcd6090},
        {"hotpink4",0x8b3a62},
        {"pink1",0xffb5c5},
        {"pink2",0xeea9b8},
        {"pink3",0xcd919e},
        {"pink4",0x8b636c},
        {"lightpink1",0xffaeb9},
        {"lightpink2",0xeea2ad},
        {"lightpink3",0xcd8c95},
        {"lightpink4",0x8b5f65},
        {"palevioletred1",0xff82ab},
        {"palevioletred2",0xee799f},
        {"palevioletred3",0xcd6889},
        {"palevioletred4",0x8b475d},
        {"maroon1",0xff34b3},
        {"maroon2",0xee30a7},
        {"maroon3",0xcd2990},
        {"maroon4",0x8b1c62},
        {"violetred1",0xff3e96},
        {"violetred2",0xee3a8c},
        {"violetred3",0xcd3278},
        {"violetred4",0x8b2252},
        {"magenta1",0xff00ff},
        {"magenta2",0xee00ee},
        {"magenta3",0xcd00cd},
        {"magenta4",0x8b008b},
        {"orchid1",0xff83fa},
        {"orchid2",0xee7ae9},
        {"orchid3",0xcd69c9},
        {"orchid4",0x8b4789},
        {"plum1",0xffbbff},
        {"plum2",0xeeaeee},
        {"plum3",0xcd96cd},
        {"plum4",0x8b668b},
        {"mediumorchid1",0xe066ff},
        {"mediumorchid2",0xd15fee},
        {"mediumorchid3",0xb452cd},
        {"mediumorchid4",0x7a378b},
        {"darkorchid1",0xbf3eff},
        {"darkorchid2",0xb23aee},
        {"darkorchid3",0x9a32cd},
        {"darkorchid4",0x68228b},
        {"purple1",0x9b30ff},
        {"purple2",0x912cee},
        {"purple3",0x7d26cd},
        {"purple4",0x551a8b},
        {"mediumpurple1",0xab82ff},
        {"mediumpurple2",0x9f79ee},
        {"mediumpurple3",0x8968cd},
        {"mediumpurple4",0x5d478b},
        {"thistle1",0xffe1ff},
        {"thistle2",0xeed2ee},
        {"thistle3",0xcdb5cd},
        {"thistle4",0x8b7b8b},
        {"gray0",0x000000},
        {"grey0",0x000000},
        {"gray1",0x030303},
        {"grey1",0x030303},
        {"gray2",0x050505},
        {"grey2",0x050505},
        {"gray3",0x080808},
        {"grey3",0x080808},
        {"gray4",0x0a0a0a},
        {"grey4",0x0a0a0a},
        {"gray5",0x0d0d0d},
        {"grey5",0x0d0d0d},
        {"gray6",0x0f0f0f},
        {"grey6",0x0f0f0f},
        {"gray7",0x121212},
        {"grey7",0x121212},
        {"gray8",0x141414},
        {"grey8",0x141414},
        {"gray9",0x171717},
        {"grey9",0x171717},
        {"gray10",0x1a1a1a},
        {"grey10",0x1a1a1a},
        {"gray11",0x1c1c1c},
        {"grey11",0x1c1c1c},
        {"gray12",0x1f1f1f},
        {"grey12",0x1f1f1f},
        {"gray13",0x212121},
        {"grey13",0x212121},
        {"gray14",0x242424},
        {"grey14",0x242424},
        {"gray15",0x262626},
        {"grey15",0x262626},
        {"gray16",0x292929},
        {"grey16",0x292929},
        {"gray17",0x2b2b2b},
        {"grey17",0x2b2b2b},
        {"gray18",0x2e2e2e},
        {"grey18",0x2e2e2e},
        {"gray19",0x303030},
        {"grey19",0x303030},
        {"gray20",0x333333},
        {"grey20",0x333333},
        {"gray21",0x363636},
        {"grey21",0x363636},
        {"gray22",0x383838},
        {"grey22",0x383838},
        {"gray23",0x3b3b3b},
        {"grey23",0x3b3b3b},
        {"gray24",0x3d3d3d},
        {"grey24",0x3d3d3d},
        {"gray25",0x404040},
        {"grey25",0x404040},
        {"gray26",0x424242},
        {"grey26",0x424242},
        {"gray27",0x454545},
        {"grey27",0x454545},
        {"gray28",0x474747},
        {"grey28",0x474747},
        {"gray29",0x4a4a4a},
        {"grey29",0x4a4a4a},
        {"gray30",0x4d4d4d},
        {"grey30",0x4d4d4d},
        {"gray31",0x4f4f4f},
        {"grey31",0x4f4f4f},
        {"gray32",0x525252},
        {"grey32",0x525252},
        {"gray33",0x545454},
        {"grey33",0x545454},
        {"gray34",0x575757},
        {"grey34",0x575757},
        {"gray35",0x595959},
        {"grey35",0x595959},
        {"gray36",0x5c5c5c},
        {"grey36",0x5c5c5c},
        {"gray37",0x5e5e5e},
        {"grey37",0x5e5e5e},
        {"gray38",0x616161},
        {"grey38",0x616161},
        {"gray39",0x636363},
        {"grey39",0x636363},
        {"gray40",0x666666},
        {"grey40",0x666666},
        {"gray41",0x696969},
        {"grey41",0x696969},
        {"gray42",0x6b6b6b},
        {"grey42",0x6b6b6b},
        {"gray43",0x6e6e6e},
        {"grey43",0x6e6e6e},
        {"gray44",0x707070},
        {"grey44",0x707070},
        {"gray45",0x737373},
        {"grey45",0x737373},
        {"gray46",0x757575},
        {"grey46",0x757575},
        {"gray47",0x787878},
        {"grey47",0x787878},
        {"gray48",0x7a7a7a},
        {"grey48",0x7a7a7a},
        {"gray49",0x7d7d7d},
        {"grey49",0x7d7d7d},
        {"gray50",0x7f7f7f},
        {"grey50",0x7f7f7f},
        {"gray51",0x828282},
        {"grey51",0x828282},
        {"gray52",0x858585},
        {"grey52",0x858585},
        {"gray53",0x878787},
        {"grey53",0x878787},
        {"gray54",0x8a8a8a},
        {"grey54",0x8a8a8a},
        {"gray55",0x8c8c8c},
        {"grey55",0x8c8c8c},
        {"gray56",0x8f8f8f},
        {"grey56",0x8f8f8f},
        {"gray57",0x919191},
        {"grey57",0x919191},
        {"gray58",0x949494},
        {"grey58",0x949494},
        {"gray59",0x969696},
        {"grey59",0x969696},
        {"gray60",0x999999},
        {"grey60",0x999999},
        {"gray61",0x9c9c9c},
        {"grey61",0x9c9c9c},
        {"gray62",0x9e9e9e},
        {"grey62",0x9e9e9e},
        {"gray63",0xa1a1a1},
        {"grey63",0xa1a1a1},
        {"gray64",0xa3a3a3},
        {"grey64",0xa3a3a3},
        {"gray65",0xa6a6a6},
        {"grey65",0xa6a6a6},
        {"gray66",0xa8a8a8},
        {"grey66",0xa8a8a8},
        {"gray67",0xababab},
        {"grey67",0xababab},
        {"gray68",0xadadad},
        {"grey68",0xadadad},
        {"gray69",0xb0b0b0},
        {"grey69",0xb0b0b0},
        {"gray70",0xb3b3b3},
        {"grey70",0xb3b3b3},
        {"gray71",0xb5b5b5},
        {"grey71",0xb5b5b5},
        {"gray72",0xb8b8b8},
        {"grey72",0xb8b8b8},
        {"gray73",0xbababa},
        {"grey73",0xbababa},
        {"gray74",0xbdbdbd},
        {"grey74",0xbdbdbd},
        {"gray75",0xbfbfbf},
        {"grey75",0xbfbfbf},
        {"gray76",0xc2c2c2},
        {"grey76",0xc2c2c2},
        {"gray77",0xc4c4c4},
        {"grey77",0xc4c4c4},
        {"gray78",0xc7c7c7},
        {"grey78",0xc7c7c7},
        {"gray79",0xc9c9c9},
        {"grey79",0xc9c9c9},
        {"gray80",0xcccccc},
        {"grey80",0xcccccc},
        {"gray81",0xcfcfcf},
        {"grey81",0xcfcfcf},
        {"gray82",0xd1d1d1},
        {"grey82",0xd1d1d1},
        {"gray83",0xd4d4d4},
        {"grey83",0xd4d4d4},
        {"gray84",0xd6d6d6},
        {"grey84",0xd6d6d6},
        {"gray85",0xd9d9d9},
        {"grey85",0xd9d9d9},
        {"gray86",0xdbdbdb},
        {"grey86",0xdbdbdb},
        {"gray87",0xdedede},
        {"grey87",0xdedede},
        {"gray88",0xe0e0e0},
        {"grey88",0xe0e0e0},
        {"gray89",0xe3e3e3},
        {"grey89",0xe3e3e3},
        {"gray90",0xe5e5e5},
        {"grey90",0xe5e5e5},
        {"gray91",0xe8e8e8},
        {"grey91",0xe8e8e8},
        {"gray92",0xebebeb},
        {"grey92",0xebebeb},
        {"gray93",0xededed},
        {"grey93",0xededed},
        {"gray94",0xf0f0f0},
        {"grey94",0xf0f0f0},
        {"gray95",0xf2f2f2},
        {"grey95",0xf2f2f2},
        {"gray96",0xf5f5f5},
        {"grey96",0xf5f5f5},
        {"gray97",0xf7f7f7},
        {"grey97",0xf7f7f7},
        {"gray98",0xfafafa},
        {"grey98",0xfafafa},
        {"gray99",0xfcfcfc},
        {"grey99",0xfcfcfc},
        {"gray100",0xffffff},
        {"grey100",0xffffff},
        {"dark grey",0xa9a9a9},
        {"darkgrey",0xa9a9a9},
        {"dark gray",0xa9a9a9},
        {"darkgray",0xa9a9a9},
        {"dark blue",0x00008b},
        {"darkblue",0x00008b},
        {"dark cyan",0x008b8b},
        {"darkcyan",0x008b8b},
        {"dark magenta",0x8b008b},
        {"darkmagenta",0x8b008b},
        {"dark red",0x8b0000},
        {"darkred",0x8b0000},
        {"light green",0x90ee90},
        {"lightgreen",0x90ee90},
    });
    auto it = colourNameMap.find(pystring::lower(name));
    if (it != colourNameMap.end())
    {
        uint64_t color = it->second;
        namedColour->SetColour(int((color & 0x00FF0000) >> 16), int((color & 0x0000FF00) >> 8), int((color & 0x000000FF) >> 0), 255);
        return true;
    }
    else
    {
        if (pystring::startswith(name, "#"s))
        {
            // name is #AARRGGBB or #RRGGBB
            int a, b, c, d;
            int l = sscanf(name.c_str(), "#%02x%02x%02x%02x", &a, &b, &c, &d);
            if (l == 4) { namedColour->SetColour(b, c, d, a); return true; }
            if (l == 3) { namedColour->SetColour(a, b, c, 255); return true; }
        }
    }
    return false;
}

// set colour based on a colour map indexed from 0 to 1
// uses built in 256 element colour maps
void Colour::SetColourFromMap(float index, ColourMap m, Colour *mappedColour, bool invert)
{

    const float grey[256][4] =
    {
        {0,0,0,1},
        {0.003921569f,0.003921569f,0.003921569f,1},
        {0.007843137f,0.007843137f,0.007843137f,1},
        {0.011764706f,0.011764706f,0.011764706f,1},
        {0.015686275f,0.015686275f,0.015686275f,1},
        {0.019607843f,0.019607843f,0.019607843f,1},
        {0.023529412f,0.023529412f,0.023529412f,1},
        {0.02745098f,0.02745098f,0.02745098f,1},
        {0.031372549f,0.031372549f,0.031372549f,1},
        {0.035294118f,0.035294118f,0.035294118f,1},
        {0.039215686f,0.039215686f,0.039215686f,1},
        {0.043137255f,0.043137255f,0.043137255f,1},
        {0.047058824f,0.047058824f,0.047058824f,1},
        {0.050980392f,0.050980392f,0.050980392f,1},
        {0.054901961f,0.054901961f,0.054901961f,1},
        {0.058823529f,0.058823529f,0.058823529f,1},
        {0.062745098f,0.062745098f,0.062745098f,1},
        {0.066666667f,0.066666667f,0.066666667f,1},
        {0.070588235f,0.070588235f,0.070588235f,1},
        {0.074509804f,0.074509804f,0.074509804f,1},
        {0.078431373f,0.078431373f,0.078431373f,1},
        {0.082352941f,0.082352941f,0.082352941f,1},
        {0.08627451f,0.08627451f,0.08627451f,1},
        {0.090196078f,0.090196078f,0.090196078f,1},
        {0.094117647f,0.094117647f,0.094117647f,1},
        {0.098039216f,0.098039216f,0.098039216f,1},
        {0.101960784f,0.101960784f,0.101960784f,1},
        {0.105882353f,0.105882353f,0.105882353f,1},
        {0.109803922f,0.109803922f,0.109803922f,1},
        {0.11372549f,0.11372549f,0.11372549f,1},
        {0.117647059f,0.117647059f,0.117647059f,1},
        {0.121568627f,0.121568627f,0.121568627f,1},
        {0.125490196f,0.125490196f,0.125490196f,1},
        {0.129411765f,0.129411765f,0.129411765f,1},
        {0.133333333f,0.133333333f,0.133333333f,1},
        {0.137254902f,0.137254902f,0.137254902f,1},
        {0.141176471f,0.141176471f,0.141176471f,1},
        {0.145098039f,0.145098039f,0.145098039f,1},
        {0.149019608f,0.149019608f,0.149019608f,1},
        {0.152941176f,0.152941176f,0.152941176f,1},
        {0.156862745f,0.156862745f,0.156862745f,1},
        {0.160784314f,0.160784314f,0.160784314f,1},
        {0.164705882f,0.164705882f,0.164705882f,1},
        {0.168627451f,0.168627451f,0.168627451f,1},
        {0.17254902f,0.17254902f,0.17254902f,1},
        {0.176470588f,0.176470588f,0.176470588f,1},
        {0.180392157f,0.180392157f,0.180392157f,1},
        {0.184313725f,0.184313725f,0.184313725f,1},
        {0.188235294f,0.188235294f,0.188235294f,1},
        {0.192156863f,0.192156863f,0.192156863f,1},
        {0.196078431f,0.196078431f,0.196078431f,1},
        {0.2f,0.2f,0.2f,1},
        {0.203921569f,0.203921569f,0.203921569f,1},
        {0.207843137f,0.207843137f,0.207843137f,1},
        {0.211764706f,0.211764706f,0.211764706f,1},
        {0.215686275f,0.215686275f,0.215686275f,1},
        {0.219607843f,0.219607843f,0.219607843f,1},
        {0.223529412f,0.223529412f,0.223529412f,1},
        {0.22745098f,0.22745098f,0.22745098f,1},
        {0.231372549f,0.231372549f,0.231372549f,1},
        {0.235294118f,0.235294118f,0.235294118f,1},
        {0.239215686f,0.239215686f,0.239215686f,1},
        {0.243137255f,0.243137255f,0.243137255f,1},
        {0.247058824f,0.247058824f,0.247058824f,1},
        {0.250980392f,0.250980392f,0.250980392f,1},
        {0.254901961f,0.254901961f,0.254901961f,1},
        {0.258823529f,0.258823529f,0.258823529f,1},
        {0.262745098f,0.262745098f,0.262745098f,1},
        {0.266666667f,0.266666667f,0.266666667f,1},
        {0.270588235f,0.270588235f,0.270588235f,1},
        {0.274509804f,0.274509804f,0.274509804f,1},
        {0.278431373f,0.278431373f,0.278431373f,1},
        {0.282352941f,0.282352941f,0.282352941f,1},
        {0.28627451f,0.28627451f,0.28627451f,1},
        {0.290196078f,0.290196078f,0.290196078f,1},
        {0.294117647f,0.294117647f,0.294117647f,1},
        {0.298039216f,0.298039216f,0.298039216f,1},
        {0.301960784f,0.301960784f,0.301960784f,1},
        {0.305882353f,0.305882353f,0.305882353f,1},
        {0.309803922f,0.309803922f,0.309803922f,1},
        {0.31372549f,0.31372549f,0.31372549f,1},
        {0.317647059f,0.317647059f,0.317647059f,1},
        {0.321568627f,0.321568627f,0.321568627f,1},
        {0.325490196f,0.325490196f,0.325490196f,1},
        {0.329411765f,0.329411765f,0.329411765f,1},
        {0.333333333f,0.333333333f,0.333333333f,1},
        {0.337254902f,0.337254902f,0.337254902f,1},
        {0.341176471f,0.341176471f,0.341176471f,1},
        {0.345098039f,0.345098039f,0.345098039f,1},
        {0.349019608f,0.349019608f,0.349019608f,1},
        {0.352941176f,0.352941176f,0.352941176f,1},
        {0.356862745f,0.356862745f,0.356862745f,1},
        {0.360784314f,0.360784314f,0.360784314f,1},
        {0.364705882f,0.364705882f,0.364705882f,1},
        {0.368627451f,0.368627451f,0.368627451f,1},
        {0.37254902f,0.37254902f,0.37254902f,1},
        {0.376470588f,0.376470588f,0.376470588f,1},
        {0.380392157f,0.380392157f,0.380392157f,1},
        {0.384313725f,0.384313725f,0.384313725f,1},
        {0.388235294f,0.388235294f,0.388235294f,1},
        {0.392156863f,0.392156863f,0.392156863f,1},
        {0.396078431f,0.396078431f,0.396078431f,1},
        {0.4f,0.4f,0.4f,1},
        {0.403921569f,0.403921569f,0.403921569f,1},
        {0.407843137f,0.407843137f,0.407843137f,1},
        {0.411764706f,0.411764706f,0.411764706f,1},
        {0.415686275f,0.415686275f,0.415686275f,1},
        {0.419607843f,0.419607843f,0.419607843f,1},
        {0.423529412f,0.423529412f,0.423529412f,1},
        {0.42745098f,0.42745098f,0.42745098f,1},
        {0.431372549f,0.431372549f,0.431372549f,1},
        {0.435294118f,0.435294118f,0.435294118f,1},
        {0.439215686f,0.439215686f,0.439215686f,1},
        {0.443137255f,0.443137255f,0.443137255f,1},
        {0.447058824f,0.447058824f,0.447058824f,1},
        {0.450980392f,0.450980392f,0.450980392f,1},
        {0.454901961f,0.454901961f,0.454901961f,1},
        {0.458823529f,0.458823529f,0.458823529f,1},
        {0.462745098f,0.462745098f,0.462745098f,1},
        {0.466666667f,0.466666667f,0.466666667f,1},
        {0.470588235f,0.470588235f,0.470588235f,1},
        {0.474509804f,0.474509804f,0.474509804f,1},
        {0.478431373f,0.478431373f,0.478431373f,1},
        {0.482352941f,0.482352941f,0.482352941f,1},
        {0.48627451f,0.48627451f,0.48627451f,1},
        {0.490196078f,0.490196078f,0.490196078f,1},
        {0.494117647f,0.494117647f,0.494117647f,1},
        {0.498039216f,0.498039216f,0.498039216f,1},
        {0.501960784f,0.501960784f,0.501960784f,1},
        {0.505882353f,0.505882353f,0.505882353f,1},
        {0.509803922f,0.509803922f,0.509803922f,1},
        {0.51372549f,0.51372549f,0.51372549f,1},
        {0.517647059f,0.517647059f,0.517647059f,1},
        {0.521568627f,0.521568627f,0.521568627f,1},
        {0.525490196f,0.525490196f,0.525490196f,1},
        {0.529411765f,0.529411765f,0.529411765f,1},
        {0.533333333f,0.533333333f,0.533333333f,1},
        {0.537254902f,0.537254902f,0.537254902f,1},
        {0.541176471f,0.541176471f,0.541176471f,1},
        {0.545098039f,0.545098039f,0.545098039f,1},
        {0.549019608f,0.549019608f,0.549019608f,1},
        {0.552941176f,0.552941176f,0.552941176f,1},
        {0.556862745f,0.556862745f,0.556862745f,1},
        {0.560784314f,0.560784314f,0.560784314f,1},
        {0.564705882f,0.564705882f,0.564705882f,1},
        {0.568627451f,0.568627451f,0.568627451f,1},
        {0.57254902f,0.57254902f,0.57254902f,1},
        {0.576470588f,0.576470588f,0.576470588f,1},
        {0.580392157f,0.580392157f,0.580392157f,1},
        {0.584313725f,0.584313725f,0.584313725f,1},
        {0.588235294f,0.588235294f,0.588235294f,1},
        {0.592156863f,0.592156863f,0.592156863f,1},
        {0.596078431f,0.596078431f,0.596078431f,1},
        {0.6f,0.6f,0.6f,1},
        {0.603921569f,0.603921569f,0.603921569f,1},
        {0.607843137f,0.607843137f,0.607843137f,1},
        {0.611764706f,0.611764706f,0.611764706f,1},
        {0.615686275f,0.615686275f,0.615686275f,1},
        {0.619607843f,0.619607843f,0.619607843f,1},
        {0.623529412f,0.623529412f,0.623529412f,1},
        {0.62745098f,0.62745098f,0.62745098f,1},
        {0.631372549f,0.631372549f,0.631372549f,1},
        {0.635294118f,0.635294118f,0.635294118f,1},
        {0.639215686f,0.639215686f,0.639215686f,1},
        {0.643137255f,0.643137255f,0.643137255f,1},
        {0.647058824f,0.647058824f,0.647058824f,1},
        {0.650980392f,0.650980392f,0.650980392f,1},
        {0.654901961f,0.654901961f,0.654901961f,1},
        {0.658823529f,0.658823529f,0.658823529f,1},
        {0.662745098f,0.662745098f,0.662745098f,1},
        {0.666666667f,0.666666667f,0.666666667f,1},
        {0.670588235f,0.670588235f,0.670588235f,1},
        {0.674509804f,0.674509804f,0.674509804f,1},
        {0.678431373f,0.678431373f,0.678431373f,1},
        {0.682352941f,0.682352941f,0.682352941f,1},
        {0.68627451f,0.68627451f,0.68627451f,1},
        {0.690196078f,0.690196078f,0.690196078f,1},
        {0.694117647f,0.694117647f,0.694117647f,1},
        {0.698039216f,0.698039216f,0.698039216f,1},
        {0.701960784f,0.701960784f,0.701960784f,1},
        {0.705882353f,0.705882353f,0.705882353f,1},
        {0.709803922f,0.709803922f,0.709803922f,1},
        {0.71372549f,0.71372549f,0.71372549f,1},
        {0.717647059f,0.717647059f,0.717647059f,1},
        {0.721568627f,0.721568627f,0.721568627f,1},
        {0.725490196f,0.725490196f,0.725490196f,1},
        {0.729411765f,0.729411765f,0.729411765f,1},
        {0.733333333f,0.733333333f,0.733333333f,1},
        {0.737254902f,0.737254902f,0.737254902f,1},
        {0.741176471f,0.741176471f,0.741176471f,1},
        {0.745098039f,0.745098039f,0.745098039f,1},
        {0.749019608f,0.749019608f,0.749019608f,1},
        {0.752941176f,0.752941176f,0.752941176f,1},
        {0.756862745f,0.756862745f,0.756862745f,1},
        {0.760784314f,0.760784314f,0.760784314f,1},
        {0.764705882f,0.764705882f,0.764705882f,1},
        {0.768627451f,0.768627451f,0.768627451f,1},
        {0.77254902f,0.77254902f,0.77254902f,1},
        {0.776470588f,0.776470588f,0.776470588f,1},
        {0.780392157f,0.780392157f,0.780392157f,1},
        {0.784313725f,0.784313725f,0.784313725f,1},
        {0.788235294f,0.788235294f,0.788235294f,1},
        {0.792156863f,0.792156863f,0.792156863f,1},
        {0.796078431f,0.796078431f,0.796078431f,1},
        {0.8f,0.8f,0.8f,1},
        {0.803921569f,0.803921569f,0.803921569f,1},
        {0.807843137f,0.807843137f,0.807843137f,1},
        {0.811764706f,0.811764706f,0.811764706f,1},
        {0.815686275f,0.815686275f,0.815686275f,1},
        {0.819607843f,0.819607843f,0.819607843f,1},
        {0.823529412f,0.823529412f,0.823529412f,1},
        {0.82745098f,0.82745098f,0.82745098f,1},
        {0.831372549f,0.831372549f,0.831372549f,1},
        {0.835294118f,0.835294118f,0.835294118f,1},
        {0.839215686f,0.839215686f,0.839215686f,1},
        {0.843137255f,0.843137255f,0.843137255f,1},
        {0.847058824f,0.847058824f,0.847058824f,1},
        {0.850980392f,0.850980392f,0.850980392f,1},
        {0.854901961f,0.854901961f,0.854901961f,1},
        {0.858823529f,0.858823529f,0.858823529f,1},
        {0.862745098f,0.862745098f,0.862745098f,1},
        {0.866666667f,0.866666667f,0.866666667f,1},
        {0.870588235f,0.870588235f,0.870588235f,1},
        {0.874509804f,0.874509804f,0.874509804f,1},
        {0.878431373f,0.878431373f,0.878431373f,1},
        {0.882352941f,0.882352941f,0.882352941f,1},
        {0.88627451f,0.88627451f,0.88627451f,1},
        {0.890196078f,0.890196078f,0.890196078f,1},
        {0.894117647f,0.894117647f,0.894117647f,1},
        {0.898039216f,0.898039216f,0.898039216f,1},
        {0.901960784f,0.901960784f,0.901960784f,1},
        {0.905882353f,0.905882353f,0.905882353f,1},
        {0.909803922f,0.909803922f,0.909803922f,1},
        {0.91372549f,0.91372549f,0.91372549f,1},
        {0.917647059f,0.917647059f,0.917647059f,1},
        {0.921568627f,0.921568627f,0.921568627f,1},
        {0.925490196f,0.925490196f,0.925490196f,1},
        {0.929411765f,0.929411765f,0.929411765f,1},
        {0.933333333f,0.933333333f,0.933333333f,1},
        {0.937254902f,0.937254902f,0.937254902f,1},
        {0.941176471f,0.941176471f,0.941176471f,1},
        {0.945098039f,0.945098039f,0.945098039f,1},
        {0.949019608f,0.949019608f,0.949019608f,1},
        {0.952941176f,0.952941176f,0.952941176f,1},
        {0.956862745f,0.956862745f,0.956862745f,1},
        {0.960784314f,0.960784314f,0.960784314f,1},
        {0.964705882f,0.964705882f,0.964705882f,1},
        {0.968627451f,0.968627451f,0.968627451f,1},
        {0.97254902f,0.97254902f,0.97254902f,1},
        {0.976470588f,0.976470588f,0.976470588f,1},
        {0.980392157f,0.980392157f,0.980392157f,1},
        {0.984313725f,0.984313725f,0.984313725f,1},
        {0.988235294f,0.988235294f,0.988235294f,1},
        {0.992156863f,0.992156863f,0.992156863f,1},
        {0.996078431f,0.996078431f,0.996078431f,1},
        {1,1,1,1}
    };
    const float cool[256][4] =
    {
        {0,1,1,1},
        {0.0039216f,0.99608f,1,1},
        {0.0078431f,0.99216f,1,1},
        {0.011765f,0.98824f,1,1},
        {0.015686f,0.98431f,1,1},
        {0.019608f,0.98039f,1,1},
        {0.023529f,0.97647f,1,1},
        {0.027451f,0.97255f,1,1},
        {0.031373f,0.96863f,1,1},
        {0.035294f,0.96471f,1,1},
        {0.039216f,0.96078f,1,1},
        {0.043137f,0.95686f,1,1},
        {0.047059f,0.95294f,1,1},
        {0.05098f,0.94902f,1,1},
        {0.054902f,0.9451f,1,1},
        {0.058824f,0.94118f,1,1},
        {0.062745f,0.93725f,1,1},
        {0.066667f,0.93333f,1,1},
        {0.070588f,0.92941f,1,1},
        {0.07451f,0.92549f,1,1},
        {0.078431f,0.92157f,1,1},
        {0.082353f,0.91765f,1,1},
        {0.086275f,0.91373f,1,1},
        {0.090196f,0.9098f,1,1},
        {0.094118f,0.90588f,1,1},
        {0.098039f,0.90196f,1,1},
        {0.10196f,0.89804f,1,1},
        {0.10588f,0.89412f,1,1},
        {0.1098f,0.8902f,1,1},
        {0.11373f,0.88627f,1,1},
        {0.11765f,0.88235f,1,1},
        {0.12157f,0.87843f,1,1},
        {0.12549f,0.87451f,1,1},
        {0.12941f,0.87059f,1,1},
        {0.13333f,0.86667f,1,1},
        {0.13725f,0.86275f,1,1},
        {0.14118f,0.85882f,1,1},
        {0.1451f,0.8549f,1,1},
        {0.14902f,0.85098f,1,1},
        {0.15294f,0.84706f,1,1},
        {0.15686f,0.84314f,1,1},
        {0.16078f,0.83922f,1,1},
        {0.16471f,0.83529f,1,1},
        {0.16863f,0.83137f,1,1},
        {0.17255f,0.82745f,1,1},
        {0.17647f,0.82353f,1,1},
        {0.18039f,0.81961f,1,1},
        {0.18431f,0.81569f,1,1},
        {0.18824f,0.81176f,1,1},
        {0.19216f,0.80784f,1,1},
        {0.19608f,0.80392f,1,1},
        {0.2f,0.8f,1,1},
        {0.20392f,0.79608f,1,1},
        {0.20784f,0.79216f,1,1},
        {0.21176f,0.78824f,1,1},
        {0.21569f,0.78431f,1,1},
        {0.21961f,0.78039f,1,1},
        {0.22353f,0.77647f,1,1},
        {0.22745f,0.77255f,1,1},
        {0.23137f,0.76863f,1,1},
        {0.23529f,0.76471f,1,1},
        {0.23922f,0.76078f,1,1},
        {0.24314f,0.75686f,1,1},
        {0.24706f,0.75294f,1,1},
        {0.25098f,0.74902f,1,1},
        {0.2549f,0.7451f,1,1},
        {0.25882f,0.74118f,1,1},
        {0.26275f,0.73725f,1,1},
        {0.26667f,0.73333f,1,1},
        {0.27059f,0.72941f,1,1},
        {0.27451f,0.72549f,1,1},
        {0.27843f,0.72157f,1,1},
        {0.28235f,0.71765f,1,1},
        {0.28627f,0.71373f,1,1},
        {0.2902f,0.7098f,1,1},
        {0.29412f,0.70588f,1,1},
        {0.29804f,0.70196f,1,1},
        {0.30196f,0.69804f,1,1},
        {0.30588f,0.69412f,1,1},
        {0.3098f,0.6902f,1,1},
        {0.31373f,0.68627f,1,1},
        {0.31765f,0.68235f,1,1},
        {0.32157f,0.67843f,1,1},
        {0.32549f,0.67451f,1,1},
        {0.32941f,0.67059f,1,1},
        {0.33333f,0.66667f,1,1},
        {0.33725f,0.66275f,1,1},
        {0.34118f,0.65882f,1,1},
        {0.3451f,0.6549f,1,1},
        {0.34902f,0.65098f,1,1},
        {0.35294f,0.64706f,1,1},
        {0.35686f,0.64314f,1,1},
        {0.36078f,0.63922f,1,1},
        {0.36471f,0.63529f,1,1},
        {0.36863f,0.63137f,1,1},
        {0.37255f,0.62745f,1,1},
        {0.37647f,0.62353f,1,1},
        {0.38039f,0.61961f,1,1},
        {0.38431f,0.61569f,1,1},
        {0.38824f,0.61176f,1,1},
        {0.39216f,0.60784f,1,1},
        {0.39608f,0.60392f,1,1},
        {0.4f,0.6f,1,1},
        {0.40392f,0.59608f,1,1},
        {0.40784f,0.59216f,1,1},
        {0.41176f,0.58824f,1,1},
        {0.41569f,0.58431f,1,1},
        {0.41961f,0.58039f,1,1},
        {0.42353f,0.57647f,1,1},
        {0.42745f,0.57255f,1,1},
        {0.43137f,0.56863f,1,1},
        {0.43529f,0.56471f,1,1},
        {0.43922f,0.56078f,1,1},
        {0.44314f,0.55686f,1,1},
        {0.44706f,0.55294f,1,1},
        {0.45098f,0.54902f,1,1},
        {0.4549f,0.5451f,1,1},
        {0.45882f,0.54118f,1,1},
        {0.46275f,0.53725f,1,1},
        {0.46667f,0.53333f,1,1},
        {0.47059f,0.52941f,1,1},
        {0.47451f,0.52549f,1,1},
        {0.47843f,0.52157f,1,1},
        {0.48235f,0.51765f,1,1},
        {0.48627f,0.51373f,1,1},
        {0.4902f,0.5098f,1,1},
        {0.49412f,0.50588f,1,1},
        {0.49804f,0.50196f,1,1},
        {0.50196f,0.49804f,1,1},
        {0.50588f,0.49412f,1,1},
        {0.5098f,0.4902f,1,1},
        {0.51373f,0.48627f,1,1},
        {0.51765f,0.48235f,1,1},
        {0.52157f,0.47843f,1,1},
        {0.52549f,0.47451f,1,1},
        {0.52941f,0.47059f,1,1},
        {0.53333f,0.46667f,1,1},
        {0.53725f,0.46275f,1,1},
        {0.54118f,0.45882f,1,1},
        {0.5451f,0.4549f,1,1},
        {0.54902f,0.45098f,1,1},
        {0.55294f,0.44706f,1,1},
        {0.55686f,0.44314f,1,1},
        {0.56078f,0.43922f,1,1},
        {0.56471f,0.43529f,1,1},
        {0.56863f,0.43137f,1,1},
        {0.57255f,0.42745f,1,1},
        {0.57647f,0.42353f,1,1},
        {0.58039f,0.41961f,1,1},
        {0.58431f,0.41569f,1,1},
        {0.58824f,0.41176f,1,1},
        {0.59216f,0.40784f,1,1},
        {0.59608f,0.40392f,1,1},
        {0.6f,0.4f,1,1},
        {0.60392f,0.39608f,1,1},
        {0.60784f,0.39216f,1,1},
        {0.61176f,0.38824f,1,1},
        {0.61569f,0.38431f,1,1},
        {0.61961f,0.38039f,1,1},
        {0.62353f,0.37647f,1,1},
        {0.62745f,0.37255f,1,1},
        {0.63137f,0.36863f,1,1},
        {0.63529f,0.36471f,1,1},
        {0.63922f,0.36078f,1,1},
        {0.64314f,0.35686f,1,1},
        {0.64706f,0.35294f,1,1},
        {0.65098f,0.34902f,1,1},
        {0.6549f,0.3451f,1,1},
        {0.65882f,0.34118f,1,1},
        {0.66275f,0.33725f,1,1},
        {0.66667f,0.33333f,1,1},
        {0.67059f,0.32941f,1,1},
        {0.67451f,0.32549f,1,1},
        {0.67843f,0.32157f,1,1},
        {0.68235f,0.31765f,1,1},
        {0.68627f,0.31373f,1,1},
        {0.6902f,0.3098f,1,1},
        {0.69412f,0.30588f,1,1},
        {0.69804f,0.30196f,1,1},
        {0.70196f,0.29804f,1,1},
        {0.70588f,0.29412f,1,1},
        {0.7098f,0.2902f,1,1},
        {0.71373f,0.28627f,1,1},
        {0.71765f,0.28235f,1,1},
        {0.72157f,0.27843f,1,1},
        {0.72549f,0.27451f,1,1},
        {0.72941f,0.27059f,1,1},
        {0.73333f,0.26667f,1,1},
        {0.73725f,0.26275f,1,1},
        {0.74118f,0.25882f,1,1},
        {0.7451f,0.2549f,1,1},
        {0.74902f,0.25098f,1,1},
        {0.75294f,0.24706f,1,1},
        {0.75686f,0.24314f,1,1},
        {0.76078f,0.23922f,1,1},
        {0.76471f,0.23529f,1,1},
        {0.76863f,0.23137f,1,1},
        {0.77255f,0.22745f,1,1},
        {0.77647f,0.22353f,1,1},
        {0.78039f,0.21961f,1,1},
        {0.78431f,0.21569f,1,1},
        {0.78824f,0.21176f,1,1},
        {0.79216f,0.20784f,1,1},
        {0.79608f,0.20392f,1,1},
        {0.8f,0.2f,1,1},
        {0.80392f,0.19608f,1,1},
        {0.80784f,0.19216f,1,1},
        {0.81176f,0.18824f,1,1},
        {0.81569f,0.18431f,1,1},
        {0.81961f,0.18039f,1,1},
        {0.82353f,0.17647f,1,1},
        {0.82745f,0.17255f,1,1},
        {0.83137f,0.16863f,1,1},
        {0.83529f,0.16471f,1,1},
        {0.83922f,0.16078f,1,1},
        {0.84314f,0.15686f,1,1},
        {0.84706f,0.15294f,1,1},
        {0.85098f,0.14902f,1,1},
        {0.8549f,0.1451f,1,1},
        {0.85882f,0.14118f,1,1},
        {0.86275f,0.13725f,1,1},
        {0.86667f,0.13333f,1,1},
        {0.87059f,0.12941f,1,1},
        {0.87451f,0.12549f,1,1},
        {0.87843f,0.12157f,1,1},
        {0.88235f,0.11765f,1,1},
        {0.88627f,0.11373f,1,1},
        {0.8902f,0.1098f,1,1},
        {0.89412f,0.10588f,1,1},
        {0.89804f,0.10196f,1,1},
        {0.90196f,0.098039f,1,1},
        {0.90588f,0.094118f,1,1},
        {0.9098f,0.090196f,1,1},
        {0.91373f,0.086275f,1,1},
        {0.91765f,0.082353f,1,1},
        {0.92157f,0.078431f,1,1},
        {0.92549f,0.07451f,1,1},
        {0.92941f,0.070588f,1,1},
        {0.93333f,0.066667f,1,1},
        {0.93725f,0.062745f,1,1},
        {0.94118f,0.058824f,1,1},
        {0.9451f,0.054902f,1,1},
        {0.94902f,0.05098f,1,1},
        {0.95294f,0.047059f,1,1},
        {0.95686f,0.043137f,1,1},
        {0.96078f,0.039216f,1,1},
        {0.96471f,0.035294f,1,1},
        {0.96863f,0.031373f,1,1},
        {0.97255f,0.027451f,1,1},
        {0.97647f,0.023529f,1,1},
        {0.98039f,0.019608f,1,1},
        {0.98431f,0.015686f,1,1},
        {0.98824f,0.011765f,1,1},
        {0.99216f,0.0078431f,1,1},
        {0.99608f,0.0039216f,1,1},
        {1,0,1,1}
    };
    const float hot[256][4] =
    {
        {0.010417f,0,0,1},
        {0.020833f,0,0,1},
        {0.03125f,0,0,1},
        {0.041667f,0,0,1},
        {0.052083f,0,0,1},
        {0.0625f,0,0,1},
        {0.072917f,0,0,1},
        {0.083333f,0,0,1},
        {0.09375f,0,0,1},
        {0.10417f,0,0,1},
        {0.11458f,0,0,1},
        {0.125f,0,0,1},
        {0.13542f,0,0,1},
        {0.14583f,0,0,1},
        {0.15625f,0,0,1},
        {0.16667f,0,0,1},
        {0.17708f,0,0,1},
        {0.1875f,0,0,1},
        {0.19792f,0,0,1},
        {0.20833f,0,0,1},
        {0.21875f,0,0,1},
        {0.22917f,0,0,1},
        {0.23958f,0,0,1},
        {0.25f,0,0,1},
        {0.26042f,0,0,1},
        {0.27083f,0,0,1},
        {0.28125f,0,0,1},
        {0.29167f,0,0,1},
        {0.30208f,0,0,1},
        {0.3125f,0,0,1},
        {0.32292f,0,0,1},
        {0.33333f,0,0,1},
        {0.34375f,0,0,1},
        {0.35417f,0,0,1},
        {0.36458f,0,0,1},
        {0.375f,0,0,1},
        {0.38542f,0,0,1},
        {0.39583f,0,0,1},
        {0.40625f,0,0,1},
        {0.41667f,0,0,1},
        {0.42708f,0,0,1},
        {0.4375f,0,0,1},
        {0.44792f,0,0,1},
        {0.45833f,0,0,1},
        {0.46875f,0,0,1},
        {0.47917f,0,0,1},
        {0.48958f,0,0,1},
        {0.5f,0,0,1},
        {0.51042f,0,0,1},
        {0.52083f,0,0,1},
        {0.53125f,0,0,1},
        {0.54167f,0,0,1},
        {0.55208f,0,0,1},
        {0.5625f,0,0,1},
        {0.57292f,0,0,1},
        {0.58333f,0,0,1},
        {0.59375f,0,0,1},
        {0.60417f,0,0,1},
        {0.61458f,0,0,1},
        {0.625f,0,0,1},
        {0.63542f,0,0,1},
        {0.64583f,0,0,1},
        {0.65625f,0,0,1},
        {0.66667f,0,0,1},
        {0.67708f,0,0,1},
        {0.6875f,0,0,1},
        {0.69792f,0,0,1},
        {0.70833f,0,0,1},
        {0.71875f,0,0,1},
        {0.72917f,0,0,1},
        {0.73958f,0,0,1},
        {0.75f,0,0,1},
        {0.76042f,0,0,1},
        {0.77083f,0,0,1},
        {0.78125f,0,0,1},
        {0.79167f,0,0,1},
        {0.80208f,0,0,1},
        {0.8125f,0,0,1},
        {0.82292f,0,0,1},
        {0.83333f,0,0,1},
        {0.84375f,0,0,1},
        {0.85417f,0,0,1},
        {0.86458f,0,0,1},
        {0.875f,0,0,1},
        {0.88542f,0,0,1},
        {0.89583f,0,0,1},
        {0.90625f,0,0,1},
        {0.91667f,0,0,1},
        {0.92708f,0,0,1},
        {0.9375f,0,0,1},
        {0.94792f,0,0,1},
        {0.95833f,0,0,1},
        {0.96875f,0,0,1},
        {0.97917f,0,0,1},
        {0.98958f,0,0,1},
        {1,0,0,1},
        {1,0.010417f,0,1},
        {1,0.020833f,0,1},
        {1,0.03125f,0,1},
        {1,0.041667f,0,1},
        {1,0.052083f,0,1},
        {1,0.0625f,0,1},
        {1,0.072917f,0,1},
        {1,0.083333f,0,1},
        {1,0.09375f,0,1},
        {1,0.10417f,0,1},
        {1,0.11458f,0,1},
        {1,0.125f,0,1},
        {1,0.13542f,0,1},
        {1,0.14583f,0,1},
        {1,0.15625f,0,1},
        {1,0.16667f,0,1},
        {1,0.17708f,0,1},
        {1,0.1875f,0,1},
        {1,0.19792f,0,1},
        {1,0.20833f,0,1},
        {1,0.21875f,0,1},
        {1,0.22917f,0,1},
        {1,0.23958f,0,1},
        {1,0.25f,0,1},
        {1,0.26042f,0,1},
        {1,0.27083f,0,1},
        {1,0.28125f,0,1},
        {1,0.29167f,0,1},
        {1,0.30208f,0,1},
        {1,0.3125f,0,1},
        {1,0.32292f,0,1},
        {1,0.33333f,0,1},
        {1,0.34375f,0,1},
        {1,0.35417f,0,1},
        {1,0.36458f,0,1},
        {1,0.375f,0,1},
        {1,0.38542f,0,1},
        {1,0.39583f,0,1},
        {1,0.40625f,0,1},
        {1,0.41667f,0,1},
        {1,0.42708f,0,1},
        {1,0.4375f,0,1},
        {1,0.44792f,0,1},
        {1,0.45833f,0,1},
        {1,0.46875f,0,1},
        {1,0.47917f,0,1},
        {1,0.48958f,0,1},
        {1,0.5f,0,1},
        {1,0.51042f,0,1},
        {1,0.52083f,0,1},
        {1,0.53125f,0,1},
        {1,0.54167f,0,1},
        {1,0.55208f,0,1},
        {1,0.5625f,0,1},
        {1,0.57292f,0,1},
        {1,0.58333f,0,1},
        {1,0.59375f,0,1},
        {1,0.60417f,0,1},
        {1,0.61458f,0,1},
        {1,0.625f,0,1},
        {1,0.63542f,0,1},
        {1,0.64583f,0,1},
        {1,0.65625f,0,1},
        {1,0.66667f,0,1},
        {1,0.67708f,0,1},
        {1,0.6875f,0,1},
        {1,0.69792f,0,1},
        {1,0.70833f,0,1},
        {1,0.71875f,0,1},
        {1,0.72917f,0,1},
        {1,0.73958f,0,1},
        {1,0.75f,0,1},
        {1,0.76042f,0,1},
        {1,0.77083f,0,1},
        {1,0.78125f,0,1},
        {1,0.79167f,0,1},
        {1,0.80208f,0,1},
        {1,0.8125f,0,1},
        {1,0.82292f,0,1},
        {1,0.83333f,0,1},
        {1,0.84375f,0,1},
        {1,0.85417f,0,1},
        {1,0.86458f,0,1},
        {1,0.875f,0,1},
        {1,0.88542f,0,1},
        {1,0.89583f,0,1},
        {1,0.90625f,0,1},
        {1,0.91667f,0,1},
        {1,0.92708f,0,1},
        {1,0.9375f,0,1},
        {1,0.94792f,0,1},
        {1,0.95833f,0,1},
        {1,0.96875f,0,1},
        {1,0.97917f,0,1},
        {1,0.98958f,0,1},
        {1,1,0,1},
        {1,1,0.015625f,1},
        {1,1,0.03125f,1},
        {1,1,0.046875f,1},
        {1,1,0.0625f,1},
        {1,1,0.078125f,1},
        {1,1,0.09375f,1},
        {1,1,0.10938f,1},
        {1,1,0.125f,1},
        {1,1,0.14062f,1},
        {1,1,0.15625f,1},
        {1,1,0.17188f,1},
        {1,1,0.1875f,1},
        {1,1,0.20312f,1},
        {1,1,0.21875f,1},
        {1,1,0.23438f,1},
        {1,1,0.25f,1},
        {1,1,0.26562f,1},
        {1,1,0.28125f,1},
        {1,1,0.29688f,1},
        {1,1,0.3125f,1},
        {1,1,0.32812f,1},
        {1,1,0.34375f,1},
        {1,1,0.35938f,1},
        {1,1,0.375f,1},
        {1,1,0.39062f,1},
        {1,1,0.40625f,1},
        {1,1,0.42188f,1},
        {1,1,0.4375f,1},
        {1,1,0.45312f,1},
        {1,1,0.46875f,1},
        {1,1,0.48438f,1},
        {1,1,0.5f,1},
        {1,1,0.51562f,1},
        {1,1,0.53125f,1},
        {1,1,0.54688f,1},
        {1,1,0.5625f,1},
        {1,1,0.57812f,1},
        {1,1,0.59375f,1},
        {1,1,0.60938f,1},
        {1,1,0.625f,1},
        {1,1,0.64062f,1},
        {1,1,0.65625f,1},
        {1,1,0.67188f,1},
        {1,1,0.6875f,1},
        {1,1,0.70312f,1},
        {1,1,0.71875f,1},
        {1,1,0.73438f,1},
        {1,1,0.75f,1},
        {1,1,0.76562f,1},
        {1,1,0.78125f,1},
        {1,1,0.79688f,1},
        {1,1,0.8125f,1},
        {1,1,0.82812f,1},
        {1,1,0.84375f,1},
        {1,1,0.85938f,1},
        {1,1,0.875f,1},
        {1,1,0.89062f,1},
        {1,1,0.90625f,1},
        {1,1,0.92188f,1},
        {1,1,0.9375f,1},
        {1,1,0.95312f,1},
        {1,1,0.96875f,1},
        {1,1,0.98438f,1},
        {1,1,1,1}
    };
    const float hsv[256][4] =
    {
        {1,0,0,1},
        {1,0.023438f,0,1},
        {1,0.046875f,0,1},
        {1,0.070312f,0,1},
        {1,0.09375f,0,1},
        {1,0.11719f,0,1},
        {1,0.14062f,0,1},
        {1,0.16406f,0,1},
        {1,0.1875f,0,1},
        {1,0.21094f,0,1},
        {1,0.23438f,0,1},
        {1,0.25781f,0,1},
        {1,0.28125f,0,1},
        {1,0.30469f,0,1},
        {1,0.32812f,0,1},
        {1,0.35156f,0,1},
        {1,0.375f,0,1},
        {1,0.39844f,0,1},
        {1,0.42188f,0,1},
        {1,0.44531f,0,1},
        {1,0.46875f,0,1},
        {1,0.49219f,0,1},
        {1,0.51562f,0,1},
        {1,0.53906f,0,1},
        {1,0.5625f,0,1},
        {1,0.58594f,0,1},
        {1,0.60938f,0,1},
        {1,0.63281f,0,1},
        {1,0.65625f,0,1},
        {1,0.67969f,0,1},
        {1,0.70312f,0,1},
        {1,0.72656f,0,1},
        {1,0.75f,0,1},
        {1,0.77344f,0,1},
        {1,0.79688f,0,1},
        {1,0.82031f,0,1},
        {1,0.84375f,0,1},
        {1,0.86719f,0,1},
        {1,0.89062f,0,1},
        {1,0.91406f,0,1},
        {1,0.9375f,0,1},
        {1,0.96094f,0,1},
        {1,0.98438f,0,1},
        {0.99219f,1,0,1},
        {0.96875f,1,0,1},
        {0.94531f,1,0,1},
        {0.92188f,1,0,1},
        {0.89844f,1,0,1},
        {0.875f,1,0,1},
        {0.85156f,1,0,1},
        {0.82812f,1,0,1},
        {0.80469f,1,0,1},
        {0.78125f,1,0,1},
        {0.75781f,1,0,1},
        {0.73438f,1,0,1},
        {0.71094f,1,0,1},
        {0.6875f,1,0,1},
        {0.66406f,1,0,1},
        {0.64062f,1,0,1},
        {0.61719f,1,0,1},
        {0.59375f,1,0,1},
        {0.57031f,1,0,1},
        {0.54688f,1,0,1},
        {0.52344f,1,0,1},
        {0.5f,1,0,1},
        {0.47656f,1,0,1},
        {0.45312f,1,0,1},
        {0.42969f,1,0,1},
        {0.40625f,1,0,1},
        {0.38281f,1,0,1},
        {0.35938f,1,0,1},
        {0.33594f,1,0,1},
        {0.3125f,1,0,1},
        {0.28906f,1,0,1},
        {0.26562f,1,0,1},
        {0.24219f,1,0,1},
        {0.21875f,1,0,1},
        {0.19531f,1,0,1},
        {0.17188f,1,0,1},
        {0.14844f,1,0,1},
        {0.125f,1,0,1},
        {0.10156f,1,0,1},
        {0.078125f,1,0,1},
        {0.054688f,1,0,1},
        {0.03125f,1,0,1},
        {0.0078125f,1,0,1},
        {0,1,0.015625f,1},
        {0,1,0.039062f,1},
        {0,1,0.0625f,1},
        {0,1,0.085938f,1},
        {0,1,0.10938f,1},
        {0,1,0.13281f,1},
        {0,1,0.15625f,1},
        {0,1,0.17969f,1},
        {0,1,0.20312f,1},
        {0,1,0.22656f,1},
        {0,1,0.25f,1},
        {0,1,0.27344f,1},
        {0,1,0.29688f,1},
        {0,1,0.32031f,1},
        {0,1,0.34375f,1},
        {0,1,0.36719f,1},
        {0,1,0.39062f,1},
        {0,1,0.41406f,1},
        {0,1,0.4375f,1},
        {0,1,0.46094f,1},
        {0,1,0.48438f,1},
        {0,1,0.50781f,1},
        {0,1,0.53125f,1},
        {0,1,0.55469f,1},
        {0,1,0.57812f,1},
        {0,1,0.60156f,1},
        {0,1,0.625f,1},
        {0,1,0.64844f,1},
        {0,1,0.67188f,1},
        {0,1,0.69531f,1},
        {0,1,0.71875f,1},
        {0,1,0.74219f,1},
        {0,1,0.76562f,1},
        {0,1,0.78906f,1},
        {0,1,0.8125f,1},
        {0,1,0.83594f,1},
        {0,1,0.85938f,1},
        {0,1,0.88281f,1},
        {0,1,0.90625f,1},
        {0,1,0.92969f,1},
        {0,1,0.95312f,1},
        {0,1,0.97656f,1},
        {0,1,1,1},
        {0,0.97656f,1,1},
        {0,0.95312f,1,1},
        {0,0.92969f,1,1},
        {0,0.90625f,1,1},
        {0,0.88281f,1,1},
        {0,0.85938f,1,1},
        {0,0.83594f,1,1},
        {0,0.8125f,1,1},
        {0,0.78906f,1,1},
        {0,0.76562f,1,1},
        {0,0.74219f,1,1},
        {0,0.71875f,1,1},
        {0,0.69531f,1,1},
        {0,0.67188f,1,1},
        {0,0.64844f,1,1},
        {0,0.625f,1,1},
        {0,0.60156f,1,1},
        {0,0.57812f,1,1},
        {0,0.55469f,1,1},
        {0,0.53125f,1,1},
        {0,0.50781f,1,1},
        {0,0.48438f,1,1},
        {0,0.46094f,1,1},
        {0,0.4375f,1,1},
        {0,0.41406f,1,1},
        {0,0.39062f,1,1},
        {0,0.36719f,1,1},
        {0,0.34375f,1,1},
        {0,0.32031f,1,1},
        {0,0.29688f,1,1},
        {0,0.27344f,1,1},
        {0,0.25f,1,1},
        {0,0.22656f,1,1},
        {0,0.20312f,1,1},
        {0,0.17969f,1,1},
        {0,0.15625f,1,1},
        {0,0.13281f,1,1},
        {0,0.10938f,1,1},
        {0,0.085938f,1,1},
        {0,0.0625f,1,1},
        {0,0.039062f,1,1},
        {0,0.015625f,1,1},
        {0.0078125f,0,1,1},
        {0.03125f,0,1,1},
        {0.054688f,0,1,1},
        {0.078125f,0,1,1},
        {0.10156f,0,1,1},
        {0.125f,0,1,1},
        {0.14844f,0,1,1},
        {0.17188f,0,1,1},
        {0.19531f,0,1,1},
        {0.21875f,0,1,1},
        {0.24219f,0,1,1},
        {0.26562f,0,1,1},
        {0.28906f,0,1,1},
        {0.3125f,0,1,1},
        {0.33594f,0,1,1},
        {0.35938f,0,1,1},
        {0.38281f,0,1,1},
        {0.40625f,0,1,1},
        {0.42969f,0,1,1},
        {0.45312f,0,1,1},
        {0.47656f,0,1,1},
        {0.5f,0,1,1},
        {0.52344f,0,1,1},
        {0.54688f,0,1,1},
        {0.57031f,0,1,1},
        {0.59375f,0,1,1},
        {0.61719f,0,1,1},
        {0.64062f,0,1,1},
        {0.66406f,0,1,1},
        {0.6875f,0,1,1},
        {0.71094f,0,1,1},
        {0.73438f,0,1,1},
        {0.75781f,0,1,1},
        {0.78125f,0,1,1},
        {0.80469f,0,1,1},
        {0.82812f,0,1,1},
        {0.85156f,0,1,1},
        {0.875f,0,1,1},
        {0.89844f,0,1,1},
        {0.92188f,0,1,1},
        {0.94531f,0,1,1},
        {0.96875f,0,1,1},
        {0.99219f,0,1,1},
        {1,0,0.98438f,1},
        {1,0,0.96094f,1},
        {1,0,0.9375f,1},
        {1,0,0.91406f,1},
        {1,0,0.89062f,1},
        {1,0,0.86719f,1},
        {1,0,0.84375f,1},
        {1,0,0.82031f,1},
        {1,0,0.79688f,1},
        {1,0,0.77344f,1},
        {1,0,0.75f,1},
        {1,0,0.72656f,1},
        {1,0,0.70312f,1},
        {1,0,0.67969f,1},
        {1,0,0.65625f,1},
        {1,0,0.63281f,1},
        {1,0,0.60938f,1},
        {1,0,0.58594f,1},
        {1,0,0.5625f,1},
        {1,0,0.53906f,1},
        {1,0,0.51562f,1},
        {1,0,0.49219f,1},
        {1,0,0.46875f,1},
        {1,0,0.44531f,1},
        {1,0,0.42188f,1},
        {1,0,0.39844f,1},
        {1,0,0.375f,1},
        {1,0,0.35156f,1},
        {1,0,0.32812f,1},
        {1,0,0.30469f,1},
        {1,0,0.28125f,1},
        {1,0,0.25781f,1},
        {1,0,0.23438f,1},
        {1,0,0.21094f,1},
        {1,0,0.1875f,1},
        {1,0,0.16406f,1},
        {1,0,0.14062f,1},
        {1,0,0.11719f,1},
        {1,0,0.09375f,1},
        {1,0,0.070312f,1},
        {1,0,0.046875f,1},
        {1,0,0.023438f,1}
    };
    const float jet[256][4] =
    {
        {0,0,0.51562f,1},
        {0,0,0.53125f,1},
        {0,0,0.54688f,1},
        {0,0,0.5625f,1},
        {0,0,0.57812f,1},
        {0,0,0.59375f,1},
        {0,0,0.60938f,1},
        {0,0,0.625f,1},
        {0,0,0.64062f,1},
        {0,0,0.65625f,1},
        {0,0,0.67188f,1},
        {0,0,0.6875f,1},
        {0,0,0.70312f,1},
        {0,0,0.71875f,1},
        {0,0,0.73438f,1},
        {0,0,0.75f,1},
        {0,0,0.76562f,1},
        {0,0,0.78125f,1},
        {0,0,0.79688f,1},
        {0,0,0.8125f,1},
        {0,0,0.82812f,1},
        {0,0,0.84375f,1},
        {0,0,0.85938f,1},
        {0,0,0.875f,1},
        {0,0,0.89062f,1},
        {0,0,0.90625f,1},
        {0,0,0.92188f,1},
        {0,0,0.9375f,1},
        {0,0,0.95312f,1},
        {0,0,0.96875f,1},
        {0,0,0.98438f,1},
        {0,0,1,1},
        {0,0.015625f,1,1},
        {0,0.03125f,1,1},
        {0,0.046875f,1,1},
        {0,0.0625f,1,1},
        {0,0.078125f,1,1},
        {0,0.09375f,1,1},
        {0,0.10938f,1,1},
        {0,0.125f,1,1},
        {0,0.14062f,1,1},
        {0,0.15625f,1,1},
        {0,0.17188f,1,1},
        {0,0.1875f,1,1},
        {0,0.20312f,1,1},
        {0,0.21875f,1,1},
        {0,0.23438f,1,1},
        {0,0.25f,1,1},
        {0,0.26562f,1,1},
        {0,0.28125f,1,1},
        {0,0.29688f,1,1},
        {0,0.3125f,1,1},
        {0,0.32812f,1,1},
        {0,0.34375f,1,1},
        {0,0.35938f,1,1},
        {0,0.375f,1,1},
        {0,0.39062f,1,1},
        {0,0.40625f,1,1},
        {0,0.42188f,1,1},
        {0,0.4375f,1,1},
        {0,0.45312f,1,1},
        {0,0.46875f,1,1},
        {0,0.48438f,1,1},
        {0,0.5f,1,1},
        {0,0.51562f,1,1},
        {0,0.53125f,1,1},
        {0,0.54688f,1,1},
        {0,0.5625f,1,1},
        {0,0.57812f,1,1},
        {0,0.59375f,1,1},
        {0,0.60938f,1,1},
        {0,0.625f,1,1},
        {0,0.64062f,1,1},
        {0,0.65625f,1,1},
        {0,0.67188f,1,1},
        {0,0.6875f,1,1},
        {0,0.70312f,1,1},
        {0,0.71875f,1,1},
        {0,0.73438f,1,1},
        {0,0.75f,1,1},
        {0,0.76562f,1,1},
        {0,0.78125f,1,1},
        {0,0.79688f,1,1},
        {0,0.8125f,1,1},
        {0,0.82812f,1,1},
        {0,0.84375f,1,1},
        {0,0.85938f,1,1},
        {0,0.875f,1,1},
        {0,0.89062f,1,1},
        {0,0.90625f,1,1},
        {0,0.92188f,1,1},
        {0,0.9375f,1,1},
        {0,0.95312f,1,1},
        {0,0.96875f,1,1},
        {0,0.98438f,1,1},
        {0,1,1,1},
        {0.015625f,1,0.98438f,1},
        {0.03125f,1,0.96875f,1},
        {0.046875f,1,0.95312f,1},
        {0.0625f,1,0.9375f,1},
        {0.078125f,1,0.92188f,1},
        {0.09375f,1,0.90625f,1},
        {0.10938f,1,0.89062f,1},
        {0.125f,1,0.875f,1},
        {0.14062f,1,0.85938f,1},
        {0.15625f,1,0.84375f,1},
        {0.17188f,1,0.82812f,1},
        {0.1875f,1,0.8125f,1},
        {0.20312f,1,0.79688f,1},
        {0.21875f,1,0.78125f,1},
        {0.23438f,1,0.76562f,1},
        {0.25f,1,0.75f,1},
        {0.26562f,1,0.73438f,1},
        {0.28125f,1,0.71875f,1},
        {0.29688f,1,0.70312f,1},
        {0.3125f,1,0.6875f,1},
        {0.32812f,1,0.67188f,1},
        {0.34375f,1,0.65625f,1},
        {0.35938f,1,0.64062f,1},
        {0.375f,1,0.625f,1},
        {0.39062f,1,0.60938f,1},
        {0.40625f,1,0.59375f,1},
        {0.42188f,1,0.57812f,1},
        {0.4375f,1,0.5625f,1},
        {0.45312f,1,0.54688f,1},
        {0.46875f,1,0.53125f,1},
        {0.48438f,1,0.51562f,1},
        {0.5f,1,0.5f,1},
        {0.51562f,1,0.48438f,1},
        {0.53125f,1,0.46875f,1},
        {0.54688f,1,0.45312f,1},
        {0.5625f,1,0.4375f,1},
        {0.57812f,1,0.42188f,1},
        {0.59375f,1,0.40625f,1},
        {0.60938f,1,0.39062f,1},
        {0.625f,1,0.375f,1},
        {0.64062f,1,0.35938f,1},
        {0.65625f,1,0.34375f,1},
        {0.67188f,1,0.32812f,1},
        {0.6875f,1,0.3125f,1},
        {0.70312f,1,0.29688f,1},
        {0.71875f,1,0.28125f,1},
        {0.73438f,1,0.26562f,1},
        {0.75f,1,0.25f,1},
        {0.76562f,1,0.23438f,1},
        {0.78125f,1,0.21875f,1},
        {0.79688f,1,0.20312f,1},
        {0.8125f,1,0.1875f,1},
        {0.82812f,1,0.17188f,1},
        {0.84375f,1,0.15625f,1},
        {0.85938f,1,0.14062f,1},
        {0.875f,1,0.125f,1},
        {0.89062f,1,0.10938f,1},
        {0.90625f,1,0.09375f,1},
        {0.92188f,1,0.078125f,1},
        {0.9375f,1,0.0625f,1},
        {0.95312f,1,0.046875f,1},
        {0.96875f,1,0.03125f,1},
        {0.98438f,1,0.015625f,1},
        {1,1,0,1},
        {1,0.98438f,0,1},
        {1,0.96875f,0,1},
        {1,0.95312f,0,1},
        {1,0.9375f,0,1},
        {1,0.92188f,0,1},
        {1,0.90625f,0,1},
        {1,0.89062f,0,1},
        {1,0.875f,0,1},
        {1,0.85938f,0,1},
        {1,0.84375f,0,1},
        {1,0.82812f,0,1},
        {1,0.8125f,0,1},
        {1,0.79688f,0,1},
        {1,0.78125f,0,1},
        {1,0.76562f,0,1},
        {1,0.75f,0,1},
        {1,0.73438f,0,1},
        {1,0.71875f,0,1},
        {1,0.70312f,0,1},
        {1,0.6875f,0,1},
        {1,0.67188f,0,1},
        {1,0.65625f,0,1},
        {1,0.64062f,0,1},
        {1,0.625f,0,1},
        {1,0.60938f,0,1},
        {1,0.59375f,0,1},
        {1,0.57812f,0,1},
        {1,0.5625f,0,1},
        {1,0.54688f,0,1},
        {1,0.53125f,0,1},
        {1,0.51562f,0,1},
        {1,0.5f,0,1},
        {1,0.48438f,0,1},
        {1,0.46875f,0,1},
        {1,0.45312f,0,1},
        {1,0.4375f,0,1},
        {1,0.42188f,0,1},
        {1,0.40625f,0,1},
        {1,0.39062f,0,1},
        {1,0.375f,0,1},
        {1,0.35938f,0,1},
        {1,0.34375f,0,1},
        {1,0.32812f,0,1},
        {1,0.3125f,0,1},
        {1,0.29688f,0,1},
        {1,0.28125f,0,1},
        {1,0.26562f,0,1},
        {1,0.25f,0,1},
        {1,0.23438f,0,1},
        {1,0.21875f,0,1},
        {1,0.20312f,0,1},
        {1,0.1875f,0,1},
        {1,0.17188f,0,1},
        {1,0.15625f,0,1},
        {1,0.14062f,0,1},
        {1,0.125f,0,1},
        {1,0.10938f,0,1},
        {1,0.09375f,0,1},
        {1,0.078125f,0,1},
        {1,0.0625f,0,1},
        {1,0.046875f,0,1},
        {1,0.03125f,0,1},
        {1,0.015625f,0,1},
        {1,0,0,1},
        {0.98438f,0,0,1},
        {0.96875f,0,0,1},
        {0.95312f,0,0,1},
        {0.9375f,0,0,1},
        {0.92188f,0,0,1},
        {0.90625f,0,0,1},
        {0.89062f,0,0,1},
        {0.875f,0,0,1},
        {0.85938f,0,0,1},
        {0.84375f,0,0,1},
        {0.82812f,0,0,1},
        {0.8125f,0,0,1},
        {0.79688f,0,0,1},
        {0.78125f,0,0,1},
        {0.76562f,0,0,1},
        {0.75f,0,0,1},
        {0.73438f,0,0,1},
        {0.71875f,0,0,1},
        {0.70312f,0,0,1},
        {0.6875f,0,0,1},
        {0.67188f,0,0,1},
        {0.65625f,0,0,1},
        {0.64062f,0,0,1},
        {0.625f,0,0,1},
        {0.60938f,0,0,1},
        {0.59375f,0,0,1},
        {0.57812f,0,0,1},
        {0.5625f,0,0,1},
        {0.54688f,0,0,1},
        {0.53125f,0,0,1},
        {0.51562f,0,0,1},
        {0.5f,0,0,1}
    };
    const float parula[256][4] =
    {
        {0.2081f,0.1663f,0.5292f,1},
        {0.2091f,0.1721f,0.5411f,1},
        {0.2101f,0.1779f,0.553f,1},
        {0.2109f,0.1837f,0.565f,1},
        {0.2116f,0.1895f,0.5771f,1},
        {0.2121f,0.1954f,0.5892f,1},
        {0.2124f,0.2013f,0.6013f,1},
        {0.2125f,0.2072f,0.6135f,1},
        {0.2123f,0.2132f,0.6258f,1},
        {0.2118f,0.2192f,0.6381f,1},
        {0.2111f,0.2253f,0.6505f,1},
        {0.2099f,0.2315f,0.6629f,1},
        {0.2084f,0.2377f,0.6753f,1},
        {0.2063f,0.244f,0.6878f,1},
        {0.2038f,0.2503f,0.7003f,1},
        {0.2006f,0.2568f,0.7129f,1},
        {0.1968f,0.2632f,0.7255f,1},
        {0.1921f,0.2698f,0.7381f,1},
        {0.1867f,0.2764f,0.7507f,1},
        {0.1802f,0.2832f,0.7634f,1},
        {0.1728f,0.2902f,0.7762f,1},
        {0.1641f,0.2975f,0.789f,1},
        {0.1541f,0.3052f,0.8017f,1},
        {0.1427f,0.3132f,0.8145f,1},
        {0.1295f,0.3217f,0.8269f,1},
        {0.1147f,0.3306f,0.8387f,1},
        {0.0986f,0.3397f,0.8495f,1},
        {0.0816f,0.3486f,0.8588f,1},
        {0.0646f,0.3572f,0.8664f,1},
        {0.0482f,0.3651f,0.8722f,1},
        {0.0329f,0.3724f,0.8765f,1},
        {0.0213f,0.3792f,0.8796f,1},
        {0.0136f,0.3853f,0.8815f,1},
        {0.0086f,0.3911f,0.8827f,1},
        {0.006f,0.3965f,0.8833f,1},
        {0.0051f,0.4017f,0.8834f,1},
        {0.0054f,0.4066f,0.8831f,1},
        {0.0067f,0.4113f,0.8825f,1},
        {0.0089f,0.4159f,0.8816f,1},
        {0.0116f,0.4203f,0.8805f,1},
        {0.0148f,0.4246f,0.8793f,1},
        {0.0184f,0.4288f,0.8779f,1},
        {0.0223f,0.4329f,0.8763f,1},
        {0.0264f,0.437f,0.8747f,1},
        {0.0306f,0.441f,0.8729f,1},
        {0.0349f,0.4449f,0.8711f,1},
        {0.0394f,0.4488f,0.8692f,1},
        {0.0437f,0.4526f,0.8672f,1},
        {0.0477f,0.4564f,0.8652f,1},
        {0.0514f,0.4602f,0.8632f,1},
        {0.0549f,0.464f,0.8611f,1},
        {0.0582f,0.4677f,0.8589f,1},
        {0.0612f,0.4714f,0.8568f,1},
        {0.064f,0.4751f,0.8546f,1},
        {0.0666f,0.4788f,0.8525f,1},
        {0.0689f,0.4825f,0.8503f,1},
        {0.071f,0.4862f,0.8481f,1},
        {0.0729f,0.4899f,0.846f,1},
        {0.0746f,0.4937f,0.8439f,1},
        {0.0761f,0.4974f,0.8418f,1},
        {0.0773f,0.5012f,0.8398f,1},
        {0.0782f,0.5051f,0.8378f,1},
        {0.0789f,0.5089f,0.8359f,1},
        {0.0794f,0.5129f,0.8341f,1},
        {0.0795f,0.5169f,0.8324f,1},
        {0.0793f,0.521f,0.8308f,1},
        {0.0788f,0.5251f,0.8293f,1},
        {0.0778f,0.5295f,0.828f,1},
        {0.0764f,0.5339f,0.827f,1},
        {0.0746f,0.5384f,0.8261f,1},
        {0.0724f,0.5431f,0.8253f,1},
        {0.0698f,0.5479f,0.8247f,1},
        {0.0668f,0.5527f,0.8243f,1},
        {0.0636f,0.5577f,0.8239f,1},
        {0.06f,0.5627f,0.8237f,1},
        {0.0562f,0.5677f,0.8234f,1},
        {0.0523f,0.5727f,0.8231f,1},
        {0.0484f,0.5777f,0.8228f,1},
        {0.0445f,0.5826f,0.8223f,1},
        {0.0408f,0.5874f,0.8217f,1},
        {0.0372f,0.5922f,0.8209f,1},
        {0.0342f,0.5968f,0.8198f,1},
        {0.0317f,0.6012f,0.8186f,1},
        {0.0296f,0.6055f,0.8171f,1},
        {0.0279f,0.6097f,0.8154f,1},
        {0.0265f,0.6137f,0.8135f,1},
        {0.0255f,0.6176f,0.8114f,1},
        {0.0248f,0.6214f,0.8091f,1},
        {0.0243f,0.625f,0.8066f,1},
        {0.0239f,0.6285f,0.8039f,1},
        {0.0237f,0.6319f,0.801f,1},
        {0.0235f,0.6352f,0.798f,1},
        {0.0233f,0.6384f,0.7948f,1},
        {0.0231f,0.6415f,0.7916f,1},
        {0.023f,0.6445f,0.7881f,1},
        {0.0229f,0.6474f,0.7846f,1},
        {0.0227f,0.6503f,0.781f,1},
        {0.0227f,0.6531f,0.7773f,1},
        {0.0232f,0.6558f,0.7735f,1},
        {0.0238f,0.6585f,0.7696f,1},
        {0.0246f,0.6611f,0.7656f,1},
        {0.0263f,0.6637f,0.7615f,1},
        {0.0282f,0.6663f,0.7574f,1},
        {0.0306f,0.6688f,0.7532f,1},
        {0.0338f,0.6712f,0.749f,1},
        {0.0373f,0.6737f,0.7446f,1},
        {0.0418f,0.6761f,0.7402f,1},
        {0.0467f,0.6784f,0.7358f,1},
        {0.0516f,0.6808f,0.7313f,1},
        {0.0574f,0.6831f,0.7267f,1},
        {0.0629f,0.6854f,0.7221f,1},
        {0.0692f,0.6877f,0.7173f,1},
        {0.0755f,0.6899f,0.7126f,1},
        {0.082f,0.6921f,0.7078f,1},
        {0.0889f,0.6943f,0.7029f,1},
        {0.0956f,0.6965f,0.6979f,1},
        {0.1031f,0.6986f,0.6929f,1},
        {0.1104f,0.7007f,0.6878f,1},
        {0.118f,0.7028f,0.6827f,1},
        {0.1258f,0.7049f,0.6775f,1},
        {0.1335f,0.7069f,0.6723f,1},
        {0.1418f,0.7089f,0.6669f,1},
        {0.1499f,0.7109f,0.6616f,1},
        {0.1585f,0.7129f,0.6561f,1},
        {0.1671f,0.7148f,0.6507f,1},
        {0.1758f,0.7168f,0.6451f,1},
        {0.1849f,0.7186f,0.6395f,1},
        {0.1938f,0.7205f,0.6338f,1},
        {0.2033f,0.7223f,0.6281f,1},
        {0.2128f,0.7241f,0.6223f,1},
        {0.2224f,0.7259f,0.6165f,1},
        {0.2324f,0.7275f,0.6107f,1},
        {0.2423f,0.7292f,0.6048f,1},
        {0.2527f,0.7308f,0.5988f,1},
        {0.2631f,0.7324f,0.5929f,1},
        {0.2735f,0.7339f,0.5869f,1},
        {0.2845f,0.7354f,0.5809f,1},
        {0.2953f,0.7368f,0.5749f,1},
        {0.3064f,0.7381f,0.5689f,1},
        {0.3177f,0.7394f,0.563f,1},
        {0.3289f,0.7406f,0.557f,1},
        {0.3405f,0.7417f,0.5512f,1},
        {0.352f,0.7428f,0.5453f,1},
        {0.3635f,0.7438f,0.5396f,1},
        {0.3753f,0.7446f,0.5339f,1},
        {0.3869f,0.7454f,0.5283f,1},
        {0.3986f,0.7461f,0.5229f,1},
        {0.4103f,0.7467f,0.5175f,1},
        {0.4218f,0.7473f,0.5123f,1},
        {0.4334f,0.7477f,0.5072f,1},
        {0.4447f,0.7482f,0.5021f,1},
        {0.4561f,0.7485f,0.4972f,1},
        {0.4672f,0.7487f,0.4924f,1},
        {0.4783f,0.7489f,0.4877f,1},
        {0.4892f,0.7491f,0.4831f,1},
        {0.5f,0.7491f,0.4786f,1},
        {0.5106f,0.7492f,0.4741f,1},
        {0.5212f,0.7492f,0.4698f,1},
        {0.5315f,0.7491f,0.4655f,1},
        {0.5418f,0.749f,0.4613f,1},
        {0.5519f,0.7489f,0.4571f,1},
        {0.5619f,0.7487f,0.4531f,1},
        {0.5718f,0.7485f,0.449f,1},
        {0.5816f,0.7482f,0.4451f,1},
        {0.5913f,0.7479f,0.4412f,1},
        {0.6009f,0.7476f,0.4374f,1},
        {0.6103f,0.7473f,0.4335f,1},
        {0.6197f,0.7469f,0.4298f,1},
        {0.629f,0.7465f,0.4261f,1},
        {0.6382f,0.746f,0.4224f,1},
        {0.6473f,0.7456f,0.4188f,1},
        {0.6564f,0.7451f,0.4152f,1},
        {0.6653f,0.7446f,0.4116f,1},
        {0.6742f,0.7441f,0.4081f,1},
        {0.683f,0.7435f,0.4046f,1},
        {0.6918f,0.743f,0.4011f,1},
        {0.7004f,0.7424f,0.3976f,1},
        {0.7091f,0.7418f,0.3942f,1},
        {0.7176f,0.7412f,0.3908f,1},
        {0.7261f,0.7405f,0.3874f,1},
        {0.7346f,0.7399f,0.384f,1},
        {0.743f,0.7392f,0.3806f,1},
        {0.7513f,0.7385f,0.3773f,1},
        {0.7596f,0.7378f,0.3739f,1},
        {0.7679f,0.7372f,0.3706f,1},
        {0.7761f,0.7364f,0.3673f,1},
        {0.7843f,0.7357f,0.3639f,1},
        {0.7924f,0.735f,0.3606f,1},
        {0.8005f,0.7343f,0.3573f,1},
        {0.8085f,0.7336f,0.3539f,1},
        {0.8166f,0.7329f,0.3506f,1},
        {0.8246f,0.7322f,0.3472f,1},
        {0.8325f,0.7315f,0.3438f,1},
        {0.8405f,0.7308f,0.3404f,1},
        {0.8484f,0.7301f,0.337f,1},
        {0.8563f,0.7294f,0.3336f,1},
        {0.8642f,0.7288f,0.33f,1},
        {0.872f,0.7282f,0.3265f,1},
        {0.8798f,0.7276f,0.3229f,1},
        {0.8877f,0.7271f,0.3193f,1},
        {0.8954f,0.7266f,0.3156f,1},
        {0.9032f,0.7262f,0.3117f,1},
        {0.911f,0.7259f,0.3078f,1},
        {0.9187f,0.7256f,0.3038f,1},
        {0.9264f,0.7256f,0.2996f,1},
        {0.9341f,0.7256f,0.2953f,1},
        {0.9417f,0.7259f,0.2907f,1},
        {0.9493f,0.7264f,0.2859f,1},
        {0.9567f,0.7273f,0.2808f,1},
        {0.9639f,0.7285f,0.2754f,1},
        {0.9708f,0.7303f,0.2696f,1},
        {0.9773f,0.7326f,0.2634f,1},
        {0.9831f,0.7355f,0.257f,1},
        {0.9882f,0.739f,0.2504f,1},
        {0.9922f,0.7431f,0.2437f,1},
        {0.9952f,0.7476f,0.2373f,1},
        {0.9973f,0.7524f,0.231f,1},
        {0.9986f,0.7573f,0.2251f,1},
        {0.9991f,0.7624f,0.2195f,1},
        {0.999f,0.7675f,0.2141f,1},
        {0.9985f,0.7726f,0.209f,1},
        {0.9976f,0.7778f,0.2042f,1},
        {0.9964f,0.7829f,0.1995f,1},
        {0.995f,0.788f,0.1949f,1},
        {0.9933f,0.7931f,0.1905f,1},
        {0.9914f,0.7981f,0.1863f,1},
        {0.9894f,0.8032f,0.1821f,1},
        {0.9873f,0.8083f,0.178f,1},
        {0.9851f,0.8133f,0.174f,1},
        {0.9828f,0.8184f,0.17f,1},
        {0.9805f,0.8235f,0.1661f,1},
        {0.9782f,0.8286f,0.1622f,1},
        {0.9759f,0.8337f,0.1583f,1},
        {0.9736f,0.8389f,0.1544f,1},
        {0.9713f,0.8441f,0.1505f,1},
        {0.9692f,0.8494f,0.1465f,1},
        {0.9672f,0.8548f,0.1425f,1},
        {0.9654f,0.8603f,0.1385f,1},
        {0.9638f,0.8659f,0.1343f,1},
        {0.9623f,0.8716f,0.1301f,1},
        {0.9611f,0.8774f,0.1258f,1},
        {0.96f,0.8834f,0.1215f,1},
        {0.9593f,0.8895f,0.1171f,1},
        {0.9588f,0.8958f,0.1126f,1},
        {0.9586f,0.9022f,0.1082f,1},
        {0.9587f,0.9088f,0.1036f,1},
        {0.9591f,0.9155f,0.099f,1},
        {0.9599f,0.9225f,0.0944f,1},
        {0.961f,0.9296f,0.0897f,1},
        {0.9624f,0.9368f,0.085f,1},
        {0.9641f,0.9443f,0.0802f,1},
        {0.9662f,0.9518f,0.0753f,1},
        {0.9685f,0.9595f,0.0703f,1},
        {0.971f,0.9673f,0.0651f,1},
        {0.9736f,0.9752f,0.0597f,1},
        {0.9763f,0.9831f,0.0538f,1}
    };

    const float (*mapPtr)[256][4];
    switch (m)
    {
    case GreyColourMap:
        mapPtr = &grey;
        break;
    case CoolColourMap:
        mapPtr = &cool;
        break;
    case HotColourMap:
        mapPtr = &hot;
        break;
    case HSVColourMap:
        mapPtr = &hsv;
        break;
    case JetColourMap:
        mapPtr = &jet;
        break;
    case ParulaColourMap:
        mapPtr = &parula;
        break;
    }

    int i = int(index * 256);
    if (i < 0) i = 0;
    else if (i >= 256) i = 255;
    if (invert) i = 255 - i;
    mappedColour->SetColour((*mapPtr)[i][0], (*mapPtr)[i][1], (*mapPtr)[i][2], (*mapPtr)[i][3]);
}
